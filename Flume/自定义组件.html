<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>自定义组件 | Chiriri</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/doc-vuepress/favicon.ico">
    <meta name="description" content="Chiriridesu">
    
    <link rel="preload" href="/doc-vuepress/assets/css/0.styles.9c707f61.css" as="style"><link rel="preload" href="/doc-vuepress/assets/js/app.6e948bf5.js" as="script"><link rel="preload" href="/doc-vuepress/assets/js/2.3b3db5cf.js" as="script"><link rel="preload" href="/doc-vuepress/assets/js/12.4182f543.js" as="script"><link rel="prefetch" href="/doc-vuepress/assets/js/10.a0377846.js"><link rel="prefetch" href="/doc-vuepress/assets/js/100.a0779326.js"><link rel="prefetch" href="/doc-vuepress/assets/js/101.eb774c37.js"><link rel="prefetch" href="/doc-vuepress/assets/js/102.d7bd7eb1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/103.d061cdd0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/104.3bc419ac.js"><link rel="prefetch" href="/doc-vuepress/assets/js/105.dde26da3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/106.ef4eedc8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/107.bcc1af18.js"><link rel="prefetch" href="/doc-vuepress/assets/js/108.ac6be724.js"><link rel="prefetch" href="/doc-vuepress/assets/js/109.fbe31814.js"><link rel="prefetch" href="/doc-vuepress/assets/js/11.f9256ed0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/110.5418bbbf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/111.fd04926f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/112.2104312f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/113.84ede38b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/114.2d652725.js"><link rel="prefetch" href="/doc-vuepress/assets/js/115.74a6e0aa.js"><link rel="prefetch" href="/doc-vuepress/assets/js/116.40bf1f99.js"><link rel="prefetch" href="/doc-vuepress/assets/js/117.6ec4b8ef.js"><link rel="prefetch" href="/doc-vuepress/assets/js/118.d6600176.js"><link rel="prefetch" href="/doc-vuepress/assets/js/119.d59cf4df.js"><link rel="prefetch" href="/doc-vuepress/assets/js/120.8c31015e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/121.820fb991.js"><link rel="prefetch" href="/doc-vuepress/assets/js/122.765af864.js"><link rel="prefetch" href="/doc-vuepress/assets/js/123.c220ed38.js"><link rel="prefetch" href="/doc-vuepress/assets/js/124.4ed6cafc.js"><link rel="prefetch" href="/doc-vuepress/assets/js/125.4c0752f3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/126.5541b6e6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/127.ac37fc6e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/128.90ea7c55.js"><link rel="prefetch" href="/doc-vuepress/assets/js/129.92042799.js"><link rel="prefetch" href="/doc-vuepress/assets/js/13.7248eb0d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/130.5bbb5bf5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/131.0dfe2e0a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/132.5a631a5b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/133.b6972dfe.js"><link rel="prefetch" href="/doc-vuepress/assets/js/134.6740582f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/135.cdb7d299.js"><link rel="prefetch" href="/doc-vuepress/assets/js/136.67e6bd25.js"><link rel="prefetch" href="/doc-vuepress/assets/js/137.bf16b6ef.js"><link rel="prefetch" href="/doc-vuepress/assets/js/138.dabd03db.js"><link rel="prefetch" href="/doc-vuepress/assets/js/139.dd546778.js"><link rel="prefetch" href="/doc-vuepress/assets/js/14.d2ffde00.js"><link rel="prefetch" href="/doc-vuepress/assets/js/140.fb49cae4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/141.23968392.js"><link rel="prefetch" href="/doc-vuepress/assets/js/142.ae095648.js"><link rel="prefetch" href="/doc-vuepress/assets/js/143.3b3707ab.js"><link rel="prefetch" href="/doc-vuepress/assets/js/144.76b024af.js"><link rel="prefetch" href="/doc-vuepress/assets/js/145.744feddc.js"><link rel="prefetch" href="/doc-vuepress/assets/js/146.a06b3feb.js"><link rel="prefetch" href="/doc-vuepress/assets/js/147.e827397d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/148.5b7163be.js"><link rel="prefetch" href="/doc-vuepress/assets/js/149.f8d4b175.js"><link rel="prefetch" href="/doc-vuepress/assets/js/15.3179e424.js"><link rel="prefetch" href="/doc-vuepress/assets/js/150.83125449.js"><link rel="prefetch" href="/doc-vuepress/assets/js/151.afa0e4c0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/152.ed0d5316.js"><link rel="prefetch" href="/doc-vuepress/assets/js/153.08deba9f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/154.bf61d539.js"><link rel="prefetch" href="/doc-vuepress/assets/js/155.c9432381.js"><link rel="prefetch" href="/doc-vuepress/assets/js/156.1bced7d5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/157.e1eb8099.js"><link rel="prefetch" href="/doc-vuepress/assets/js/158.ece8770b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/159.bfb0b09e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/16.d3c81d2a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/160.31b5823c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/161.6bd8c06b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/162.5875fd2b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/163.8f9f07f3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/164.f68ea643.js"><link rel="prefetch" href="/doc-vuepress/assets/js/165.263bb658.js"><link rel="prefetch" href="/doc-vuepress/assets/js/166.7ae1724b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/167.1d9b566a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/168.02e8eb30.js"><link rel="prefetch" href="/doc-vuepress/assets/js/169.9800df33.js"><link rel="prefetch" href="/doc-vuepress/assets/js/17.ce11ea0b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/170.18c5c187.js"><link rel="prefetch" href="/doc-vuepress/assets/js/171.497a9d00.js"><link rel="prefetch" href="/doc-vuepress/assets/js/172.e0b62c24.js"><link rel="prefetch" href="/doc-vuepress/assets/js/173.3f46f4f1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/174.0c3dc1fa.js"><link rel="prefetch" href="/doc-vuepress/assets/js/175.5335bf12.js"><link rel="prefetch" href="/doc-vuepress/assets/js/176.ad10a358.js"><link rel="prefetch" href="/doc-vuepress/assets/js/177.074caac5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/178.676419a7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/179.1631656f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/18.a1ea0276.js"><link rel="prefetch" href="/doc-vuepress/assets/js/180.3ab6fd7f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/181.03085825.js"><link rel="prefetch" href="/doc-vuepress/assets/js/182.07d27991.js"><link rel="prefetch" href="/doc-vuepress/assets/js/183.413be218.js"><link rel="prefetch" href="/doc-vuepress/assets/js/184.0d03f7fd.js"><link rel="prefetch" href="/doc-vuepress/assets/js/185.1d56c6ad.js"><link rel="prefetch" href="/doc-vuepress/assets/js/186.774634e7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/187.8c4709fc.js"><link rel="prefetch" href="/doc-vuepress/assets/js/188.2472798e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/189.67621040.js"><link rel="prefetch" href="/doc-vuepress/assets/js/19.1407f350.js"><link rel="prefetch" href="/doc-vuepress/assets/js/190.26efcaaa.js"><link rel="prefetch" href="/doc-vuepress/assets/js/191.6234d356.js"><link rel="prefetch" href="/doc-vuepress/assets/js/192.afca641d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/193.66c1626a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/194.f2fbc834.js"><link rel="prefetch" href="/doc-vuepress/assets/js/195.3cc9cf86.js"><link rel="prefetch" href="/doc-vuepress/assets/js/196.a41363eb.js"><link rel="prefetch" href="/doc-vuepress/assets/js/197.243678d1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/198.5e828a37.js"><link rel="prefetch" href="/doc-vuepress/assets/js/199.c6282f33.js"><link rel="prefetch" href="/doc-vuepress/assets/js/20.f16a556e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/200.1d810f8b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/201.4b1671a1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/202.dc49793d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/203.0df4681f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/204.1f278001.js"><link rel="prefetch" href="/doc-vuepress/assets/js/205.30a3c1b7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/206.2196ceaf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/207.0221d2ae.js"><link rel="prefetch" href="/doc-vuepress/assets/js/208.71e3cab1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/209.e88e294f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/21.b76088d5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/210.70e835e1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/211.35276f35.js"><link rel="prefetch" href="/doc-vuepress/assets/js/212.7ea11726.js"><link rel="prefetch" href="/doc-vuepress/assets/js/213.e59846df.js"><link rel="prefetch" href="/doc-vuepress/assets/js/214.5f9fac30.js"><link rel="prefetch" href="/doc-vuepress/assets/js/22.c30ea85f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/23.217f002f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/24.32c4623a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/25.607d985e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/26.a7788a6d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/27.64f722ed.js"><link rel="prefetch" href="/doc-vuepress/assets/js/28.631dfe5c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/29.f8fad52b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/3.3d766b15.js"><link rel="prefetch" href="/doc-vuepress/assets/js/30.0ba09a2f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/31.33cb35ef.js"><link rel="prefetch" href="/doc-vuepress/assets/js/32.e02426b6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/33.122885a7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/34.935637ff.js"><link rel="prefetch" href="/doc-vuepress/assets/js/35.9ec2f5cd.js"><link rel="prefetch" href="/doc-vuepress/assets/js/36.97c03412.js"><link rel="prefetch" href="/doc-vuepress/assets/js/37.6fd9f758.js"><link rel="prefetch" href="/doc-vuepress/assets/js/38.95142af3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/39.229e6b73.js"><link rel="prefetch" href="/doc-vuepress/assets/js/4.8856a9a1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/40.5e0286b8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/41.3592bc20.js"><link rel="prefetch" href="/doc-vuepress/assets/js/42.b5e2e56d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/43.3676ecec.js"><link rel="prefetch" href="/doc-vuepress/assets/js/44.3a32f038.js"><link rel="prefetch" href="/doc-vuepress/assets/js/45.745ee8e2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/46.c1221650.js"><link rel="prefetch" href="/doc-vuepress/assets/js/47.f19c47ca.js"><link rel="prefetch" href="/doc-vuepress/assets/js/48.55a25c39.js"><link rel="prefetch" href="/doc-vuepress/assets/js/49.9c7dc3f4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/5.90f9cbf1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/50.b46ee925.js"><link rel="prefetch" href="/doc-vuepress/assets/js/51.d329d797.js"><link rel="prefetch" href="/doc-vuepress/assets/js/52.fd8f397c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/53.23909cc9.js"><link rel="prefetch" href="/doc-vuepress/assets/js/54.d13a40f3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/55.a5b55a8f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/56.cb7e2702.js"><link rel="prefetch" href="/doc-vuepress/assets/js/57.70542f2c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/58.ea52eb82.js"><link rel="prefetch" href="/doc-vuepress/assets/js/59.4656872e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/6.7862f44a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/60.095d1e6e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/61.9e8395aa.js"><link rel="prefetch" href="/doc-vuepress/assets/js/62.255b2396.js"><link rel="prefetch" href="/doc-vuepress/assets/js/63.e10e86e4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/64.971d4a9e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/65.422511e1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/66.f493e49e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/67.89f6a115.js"><link rel="prefetch" href="/doc-vuepress/assets/js/68.0a8a0065.js"><link rel="prefetch" href="/doc-vuepress/assets/js/69.a7ffb61f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/7.ffa606ad.js"><link rel="prefetch" href="/doc-vuepress/assets/js/70.8606440c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/71.849597b1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/72.a36d6c56.js"><link rel="prefetch" href="/doc-vuepress/assets/js/73.9271bec4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/74.c2c39654.js"><link rel="prefetch" href="/doc-vuepress/assets/js/75.27b46772.js"><link rel="prefetch" href="/doc-vuepress/assets/js/76.40d6b949.js"><link rel="prefetch" href="/doc-vuepress/assets/js/77.d54f69af.js"><link rel="prefetch" href="/doc-vuepress/assets/js/78.6526565f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/79.3979b3e2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/8.befc28ff.js"><link rel="prefetch" href="/doc-vuepress/assets/js/80.36cf2d03.js"><link rel="prefetch" href="/doc-vuepress/assets/js/81.4eff2717.js"><link rel="prefetch" href="/doc-vuepress/assets/js/82.77e68a3e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/83.bb62fb0d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/84.f20ba61e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/85.66f486a1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/86.4f56de68.js"><link rel="prefetch" href="/doc-vuepress/assets/js/87.b36ac2f1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/88.254d1d79.js"><link rel="prefetch" href="/doc-vuepress/assets/js/89.b889a7fb.js"><link rel="prefetch" href="/doc-vuepress/assets/js/9.65373538.js"><link rel="prefetch" href="/doc-vuepress/assets/js/90.a6ef119f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/91.f5f8b5c1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/92.aaea9d6c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/93.2a30db4b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/94.e66444ea.js"><link rel="prefetch" href="/doc-vuepress/assets/js/95.fc61c42d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/96.329fbad9.js"><link rel="prefetch" href="/doc-vuepress/assets/js/97.c3dbfbdf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/98.2d2f8ecf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/99.ce3018d2.js">
    <link rel="stylesheet" href="/doc-vuepress/assets/css/0.styles.9c707f61.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Chiriri</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc-vuepress/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaSE/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaEE/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/SQL/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/机器学习/" class="nav-link">
  机器学习
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Python模块/" class="nav-link">
  Python模块
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Flume/" class="nav-link router-link-active">
  Flume
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/前端/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc-vuepress/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaSE/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaEE/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/SQL/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/机器学习/" class="nav-link">
  机器学习
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Python模块/" class="nav-link">
  Python模块
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Flume/" class="nav-link router-link-active">
  Flume
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/前端/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/doc-vuepress/Flume/Flime基础架构.html" class="sidebar-link">Flime基础架构</a></li><li><a href="/doc-vuepress/Flume/Flume安装.html" class="sidebar-link">Flume安装</a></li><li><a href="/doc-vuepress/Flume/入门案例.html" class="sidebar-link">入门案例</a></li><li><a href="/doc-vuepress/Flume/Flume 进阶.html" class="sidebar-link">Flume 进阶</a></li><li><a href="/doc-vuepress/Flume/自定义组件.html" class="active sidebar-link">自定义组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#自定义interceptor-拦截器" class="sidebar-link">自定义Interceptor 拦截器</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#自定义-source" class="sidebar-link">自定义 Source</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#自定义-sink" class="sidebar-link">自定义 Sink</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#flume-数据流监控" class="sidebar-link">Flume 数据流监控</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#ganglia的安装与部署" class="sidebar-link">Ganglia的安装与部署</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#修改配置" class="sidebar-link">修改配置</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#启动" class="sidebar-link">启动</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/Flume/自定义组件.html#操作flume-测试监控" class="sidebar-link">操作Flume 测试监控</a></li></ul></li><li><a href="/doc-vuepress/Flume/面试题.html" class="sidebar-link">面试题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="自定义组件"><a href="#自定义组件" class="header-anchor">#</a> 自定义组件</h1> <p>http://flume.apache.org/releases/content/1.9.0/FlumeDeveloperGuide.html</p> <h2 id="自定义interceptor-拦截器"><a href="#自定义interceptor-拦截器" class="header-anchor">#</a> 自定义Interceptor 拦截器</h2> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211112113134291.png" alt="image-20211112113134291"></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#agent 1  hadoop102</span>
a1.sources <span class="token operator">=</span> r1

a1.sinks <span class="token operator">=</span> k1 k2
a1.channels <span class="token operator">=</span> c1 c2

a1.sources.r1.type <span class="token operator">=</span> netcat 
a1.sources.r1.bing <span class="token operator">=</span> hadoop102
a1.sources.r1.port <span class="token operator">=</span> <span class="token number">22222</span> 

<span class="token comment">#复用配置</span>
a1.sources.r1.selector.type <span class="token operator">=</span> multiplexing 
a1.sources.r1.selector.header <span class="token operator">=</span> <span class="token builtin class-name">type</span>
a1.sources.r1.selector.mapping.letter <span class="token operator">=</span> c1
a1.sources.r1.selector.mapping.number <span class="token operator">=</span> c2


a1.sources.r1.interceptors <span class="token operator">=</span> i1
<span class="token comment">#自定义拦截器 引入类路径 中 Builder 内部类</span>
a1.sources.r1.interceptors.i1.type <span class="token operator">=</span> comm.atguigu.demo.MyInterceptor<span class="token variable">$Builder</span>


a1.sinks.k1.type <span class="token operator">=</span> arvo 
a1.sinks.k1.hostname <span class="token operator">=</span> hadoop103
a1.sinks.k1.port <span class="token operator">=</span> <span class="token number">33333</span>

<span class="token comment">#第二个sinks</span>
a1.sinks.k2.type <span class="token operator">=</span> arvo 
a1.sinks.k2.hostname <span class="token operator">=</span> hadoop104
a1.sinks.k2.port <span class="token operator">=</span> <span class="token number">44444</span>

a1.channels.c1.type <span class="token operator">=</span> memory 
a1.channels.c1.capacity <span class="token operator">=</span> <span class="token number">1000</span> 
a1.channels.c1.transactionCapacity <span class="token operator">=</span> <span class="token number">100</span> 
<span class="token comment">#第二个channel</span>
a1.channels.c2.type <span class="token operator">=</span> memory 
a1.channels.c2.capacity <span class="token operator">=</span> <span class="token number">1000</span> 
a1.channels.c2.transactionCapacity <span class="token operator">=</span> <span class="token number">100</span> 

<span class="token comment">#一个sources 对接两个channels</span>
a1.sources.r1.channels <span class="token operator">=</span> c1 c2
<span class="token comment">#每个sinks对应一个channel</span>
a1.sinks.k1.channel <span class="token operator">=</span> c1
a1.sinks.k2.channel <span class="token operator">=</span> c2
</code></pre></div><p>agent2和agent3与之前无差</p> <p>导入pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flume<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flume-ng-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>实现Interceptor接口 重写抽象方法 并书写一个内部类实现Interceptor.Builder接口 实现抽象方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">comm<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Event</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor<span class="token punctuation">.</span></span><span class="token class-name">Interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 自定义拦截器
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">{</span>
    <span class="token comment">//初始化</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token comment">//为每个event中的header添加键值对  channelProcessor调用拦截器时调用此方法并将event传过来</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Event</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取event body中的内容</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//判断内容是否是字母</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token string">'A'</span> <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token string">'a'</span> <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//向header添加 type = letter</span>
            event<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;letter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//否则添加 type = number</span>
            event<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> event<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//遍历</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Event</span> event <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">intercept</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//关闭资源</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 返回MyInterceptor的实例
     * 1.静态内部类 公开权限
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor<span class="token punctuation">.</span>Builder</span><span class="token punctuation">{</span>

        <span class="token comment">//返回自定义拦截器类</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Interceptor</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>maven打包 上传到flume中lib文件夹</p> <div class="language-sh extra-class"><pre class="language-sh"><code>flume-ng agent -n a1 -c conf/ -f datas/flume_interceptor.conf -Dflume.root.logger<span class="token operator">=</span>INFO,console
</code></pre></div><h2 id="自定义-source"><a href="#自定义-source" class="header-anchor">#</a> 自定义 Source</h2> <p>使用flume接收数据，并给每条数据添加前缀，输出到控制台。前缀可从flume配置文件中配置。</p> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211112134553171.png" alt="image-20211112134553171"></p> <p>继承 AbstractSource 实现 Configurable, PollableSource</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">comm<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Event</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">EventDeliveryException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">PollableSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>channel<span class="token punctuation">.</span></span><span class="token class-name">ChannelProcessor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configurable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">SimpleEvent</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>source<span class="token punctuation">.</span></span><span class="token class-name">AbstractSource</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">//自定义source</span>
<span class="token comment">//使用flume接收数据，并给每条数据添加前缀，输出到控制台。前缀可从flume配置文件中配置。</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySource</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSource</span> <span class="token keyword">implements</span> <span class="token class-name">Configurable</span><span class="token punctuation">,</span> <span class="token class-name">PollableSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> prefix<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 获取数据封装成event并写入channel，这个方法将被循环调用。
     *
     * @return status 枚举类 1.READY 添加event成功  2.BACKOFF 添加event失败
     * @throws EventDeliveryException
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Status</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">EventDeliveryException</span> <span class="token punctuation">{</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//封装event</span>
                <span class="token class-name">SimpleEvent</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//event设置数据 加上前缀</span>
                event<span class="token punctuation">.</span><span class="token function">setBody</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prefix <span class="token operator">+</span> <span class="token string">&quot;hello&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//放入集合中</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//获取channelProcessor</span>
            <span class="token class-name">ChannelProcessor</span> channelProcessor <span class="token operator">=</span> <span class="token function">getChannelProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将数据放入到channel中(channelProcessor)</span>
            <span class="token comment">// channelProcessor.processEvent(event); //单个数据</span>
            channelProcessor<span class="token punctuation">.</span><span class="token function">processEventBatch</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//集合放入</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>BACKOFF<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>READY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//暂不用  当source没数据可封装时 会让source所在的线程休息会</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getBackOffSleepIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">2000L</span><span class="token punctuation">;</span> <span class="token comment">//休息2000毫秒</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//暂不用  当source没数据可封装时 会让source所在的线程休息的最大时间 如果前面休息的时间大于设置的max值 则后面都不休息(休息0毫秒)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getMaxBackOffSleepInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">5000L</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//初始化context（读取配置文件内容）</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//前缀 默认值为默认值test=</span>
        prefix <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;prefix&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打包并上传到 flume的lib中</p> <p>配置文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code>a1.sources <span class="token operator">=</span> r1  
a1.sinks <span class="token operator">=</span> k1
a1.channels <span class="token operator">=</span> c1 

<span class="token comment">#自定义sources 引用类路径</span>
a1.sources.r1.type <span class="token operator">=</span> comm.atguigu.demo.MySource
<span class="token comment">#自定义设置前缀 如果为空 则使用自定义类中默认值test=</span>
a1.sources.r1.prefix <span class="token operator">=</span> qaq

a1.sinks.k1.type <span class="token operator">=</span> logger  

a1.channels.c1.type <span class="token operator">=</span> memory 
a1.channels.c1.capacity <span class="token operator">=</span> <span class="token number">1000</span> 
a1.channels.c1.transactionCapacity <span class="token operator">=</span> <span class="token number">100</span> 

a1.sources.r1.channels <span class="token operator">=</span> c1 
a1.sinks.k1.channel <span class="token operator">=</span> c1 
</code></pre></div><h2 id="自定义-sink"><a href="#自定义-sink" class="header-anchor">#</a> 自定义 Sink</h2> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211112162904406.png" alt="image-20211112162904406"></p> <p>继承 AbstractSink 实现 Configurable</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">comm<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configurable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>sink<span class="token punctuation">.</span></span><span class="token class-name">AbstractSink</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySink</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSink</span> <span class="token keyword">implements</span> <span class="token class-name">Configurable</span> <span class="token punctuation">{</span>

    <span class="token comment">//从配置文件读取suffix的值</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> suffix<span class="token punctuation">;</span>
    <span class="token comment">//获取logger对象 可以将数据以日志的方式输出  或以 写入数据本地等持久化数据</span>
    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MySink</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 用来处理sink逻辑 将channel中的内容写出去 会被不停的循环调用
     *
     * @return
     * @throws EventDeliveryException
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Status</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">EventDeliveryException</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取channel</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取事务</span>
        <span class="token class-name">Transaction</span> transaction <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Event</span> event <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            transaction<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启事务</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                event <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取数据</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//保证event中是有数据的</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//将数据写出 此处以日志形式输出  以某种持久化形式将数据输出</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//提交事务</span>
            transaction<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ChannelException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            transaction<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//事务回滚</span>
            <span class="token keyword">return</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>BACKOFF<span class="token punctuation">;</span> <span class="token comment">//获取数据失败</span>

        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            transaction<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//关闭资源</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>READY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 获取上下文 读取配置文件中的内容
     *
     * @param context
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        suffix <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;suffix&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>打包上传到flume的lib中</p> <p>配置文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code>a1.sources <span class="token operator">=</span> r1  
a1.sinks <span class="token operator">=</span> k1
a1.channels <span class="token operator">=</span> c1 

a1.sources.r1.type <span class="token operator">=</span> netcat 
a1.sources.r1.bind <span class="token operator">=</span> localhost 
a1.sources.r1.port <span class="token operator">=</span> <span class="token number">44444</span> 

<span class="token comment">#自定义sink</span>
a1.sinks.k1.type <span class="token operator">=</span> comm.atguigu.demo.MySink
<span class="token comment">#给数据设置后缀</span>
a1.sinks.k1.suffix <span class="token operator">=</span> atguigu

a1.channels.c1.type <span class="token operator">=</span> memory 
a1.channels.c1.capacity <span class="token operator">=</span> <span class="token number">1000</span> 
a1.channels.c1.transactionCapacity <span class="token operator">=</span> <span class="token number">100</span> 

a1.sources.r1.channels <span class="token operator">=</span> c1 
a1.sinks.k1.channel <span class="token operator">=</span> c1 
</code></pre></div><h2 id="flume-数据流监控"><a href="#flume-数据流监控" class="header-anchor">#</a> Flume 数据流监控</h2> <h3 id="ganglia的安装与部署"><a href="#ganglia的安装与部署" class="header-anchor">#</a> Ganglia的安装与部署</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> yum -y <span class="token function">install</span> httpd php <span class="token comment"># 安装 httpd服务 与 php</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> rrdtool perl-rrdtool rrdtool-devel <span class="token comment"># 依赖</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> apr-devel <span class="token comment">#依赖</span>

<span class="token comment">#安装ganglia</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> epel-release
<span class="token function">sudo</span> yum -y <span class="token function">install</span> ganglia-gmetad
<span class="token function">sudo</span> yum -y <span class="token function">install</span> ganglia-web
<span class="token function">sudo</span> yum <span class="token function">install</span> -y ganglia-gmond
</code></pre></div><p>Ganglia由gmond、gmetad和gweb三部分组成。</p> <p>gmond（Ganglia Monitoring Daemon）是一种轻量级服务，<strong>安装在每台需要收集指标数据的节点主机上</strong>。使用gmond，你可以很容易收集很多系统指标数据，如CPU、内存、磁盘、网络和活跃进程的数据等。</p> <p>gmetad（Ganglia Meta Daemon）<strong>整合所有信息</strong>，并将其以RRD格式<strong>存储至磁盘</strong>的服务。</p> <p>gweb（Ganglia Web）Ganglia可视化工具，gweb是一种利用浏览器显示gmetad所存储数据的PHP前端。在Web界面中以图表方式展现集群的运行状态下收集的多种不同指标数据。</p> <h3 id="修改配置"><a href="#修改配置" class="header-anchor">#</a> 修改配置</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/httpd/conf.d/ganglia.conf
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code># Ganglia monitoring system php web frontend
Alias /ganglia /usr/share/ganglia
&lt;Location /ganglia&gt;
  Require all granted
  #Deny from all
  # Allow from 127.0.0.1
  # Allow from ::1
  # Allow from .example.com
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Location</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/ganglia/gmetad.conf
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#更改此字段的ip地址</span>
data_source <span class="token string">&quot;my_cluster&quot;</span> <span class="token number">192.168</span>.130.102 
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/ganglia/gmond.conf
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code>cluster <span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">&quot;my_cluster&quot;</span>
  owner <span class="token operator">=</span> <span class="token string">&quot;unspecified&quot;</span>
  latlong <span class="token operator">=</span> <span class="token string">&quot;unspecified&quot;</span>
  url <span class="token operator">=</span> <span class="token string">&quot;unspecified&quot;</span>
<span class="token punctuation">}</span>
udp_send_channel <span class="token punctuation">{</span>
  <span class="token comment">#bind_hostname = yes # Highly recommended, soon to be default.</span>
                       <span class="token comment"># This option tells gmond to use a source address</span>
                       <span class="token comment"># that resolves to the machine's hostname.  Without</span>
                       <span class="token comment"># this, the metrics may appear to come from any</span>
                       <span class="token comment"># interface and the DNS names associated with</span>
                       <span class="token comment"># those IPs will be used to create the RRDs.</span>
  <span class="token comment"># mcast_join = 239.2.11.71</span>
  <span class="token function">host</span> <span class="token operator">=</span> <span class="token number">192.168</span>.130.102
  port <span class="token operator">=</span> <span class="token number">8649</span>
  ttl <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
udp_recv_channel <span class="token punctuation">{</span>
  <span class="token comment"># mcast_join = 239.2.11.71</span>
  port <span class="token operator">=</span> <span class="token number">8649</span>
  <span class="token builtin class-name">bind</span> <span class="token operator">=</span> <span class="token number">192.168</span>.130.102
  retry_bind <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token comment"># Size of the UDP buffer. If you are handling lots of metrics you really</span>
  <span class="token comment"># should bump it up to e.g. 10MB or even higher.</span>
  <span class="token comment"># buffer = 10485760</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/selinux/config
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># This file controls the state of SELinux on the system.</span>
<span class="token comment"># SELINUX= can take one of these three values:</span>
<span class="token comment">#     enforcing - SELinux security policy is enforced.</span>
<span class="token comment">#     permissive - SELinux prints warnings instead of enforcing.</span>
<span class="token comment">#     disabled - No SELinux policy is loaded.</span>
<span class="token assign-left variable">SELINUX</span><span class="token operator">=</span>disabled
<span class="token comment"># SELINUXTYPE= can take one of these two values:</span>
<span class="token comment">#     targeted - Targeted processes are protected,</span>
<span class="token comment">#     mls - Multi Level Security protection.</span>
<span class="token assign-left variable">SELINUXTYPE</span><span class="token operator">=</span>targeted
</code></pre></div><p>selinux本次生效关闭<strong>必须重启</strong>，如果此时不想重启，可以临时生效之</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> setenforce <span class="token number">0</span>
</code></pre></div><h3 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">service</span> httpd start
<span class="token function">sudo</span> <span class="token function">service</span> gmetad start
<span class="token function">sudo</span> <span class="token function">service</span> gmond start
</code></pre></div><p>访问 http://192.168.130.102/ganglia</p> <p>如果完成以上操作依然出现权限不足错误，请修改/var/lib/ganglia目录的权限：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">chmod</span> -R <span class="token number">777</span> /var/lib/ganglia
</code></pre></div><h2 id="操作flume-测试监控"><a href="#操作flume-测试监控" class="header-anchor">#</a> 操作Flume 测试监控</h2> <p>进入flume下的conf目录</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /opt/module/flume/conf/
<span class="token function">mv</span> flume-env.sh.template flume-env.sh <span class="token comment">#重命名</span>
<span class="token function">vim</span> flume-env.sh 
</code></pre></div><p>追加以下配置 ip地址为ganglia主地址</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token assign-left variable">JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Dflume.monitoring.type=ganglia
-Dflume.monitoring.hosts=192.168.130.102:8649
-Xms100m
-Xmx200m&quot;</span>
</code></pre></div><p>启动flume任务</p> <div class="language-sh extra-class"><pre class="language-sh"><code>flume-ng agent <span class="token punctuation">\</span>
--conf conf/ <span class="token punctuation">\</span>
--name a1 <span class="token punctuation">\</span>
--conf-file datas/netcatsource_loggersink.conf <span class="token punctuation">\</span>
-Dflume.root.logger<span class="token operator">==</span>INFO,console <span class="token punctuation">\</span>
-Dflume.monitoring.type<span class="token operator">=</span>ganglia <span class="token punctuation">\</span>
-Dflume.monitoring.hosts<span class="token operator">=</span><span class="token number">192.168</span>.130.102:8649
</code></pre></div><p>发送信息</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">nc</span> localhost <span class="token number">44444</span>
</code></pre></div><p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211113130912256.png" alt="image-20211113130912256"></p> <p>图例说明</p> <table><thead><tr><th>字段（图表名称）</th> <th>字段含义</th></tr></thead> <tbody><tr><td>EventPutAttemptCount</td> <td>source尝试写入channel的事件总数量</td></tr> <tr><td>EventPutSuccessCount</td> <td>成功写入channel且提交的事件总数量</td></tr> <tr><td>EventTakeAttemptCount</td> <td>sink尝试从channel拉取事件的总数量。</td></tr> <tr><td>EventTakeSuccessCount</td> <td>sink成功读取的事件的总数量</td></tr> <tr><td>StartTime</td> <td>channel启动的时间（毫秒）</td></tr> <tr><td>StopTime</td> <td>channel停止的时间（毫秒）</td></tr> <tr><td>ChannelSize</td> <td>目前channel中事件的总数量</td></tr> <tr><td>ChannelFillPercentage</td> <td>channel占用百分比</td></tr> <tr><td>ChannelCapacity</td> <td>channel的容量</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/doc-vuepress/Flume/Flume 进阶.html" class="prev">
        Flume 进阶
      </a></span> <span class="next"><a href="/doc-vuepress/Flume/面试题.html">
        面试题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc-vuepress/assets/js/app.6e948bf5.js" defer></script><script src="/doc-vuepress/assets/js/2.3b3db5cf.js" defer></script><script src="/doc-vuepress/assets/js/12.4182f543.js" defer></script>
  </body>
</html>
