<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pandas | Chiriri</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/doc-vuepress/favicon.ico">
    <meta name="description" content="Chiriridesu">
    
    <link rel="preload" href="/doc-vuepress/assets/css/0.styles.f3cbd881.css" as="style"><link rel="preload" href="/doc-vuepress/assets/js/app.d9f058a2.js" as="script"><link rel="preload" href="/doc-vuepress/assets/js/2.3b3db5cf.js" as="script"><link rel="preload" href="/doc-vuepress/assets/js/226.9269748b.js" as="script"><link rel="prefetch" href="/doc-vuepress/assets/js/10.b164b477.js"><link rel="prefetch" href="/doc-vuepress/assets/js/100.9586193b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/101.fbfb8023.js"><link rel="prefetch" href="/doc-vuepress/assets/js/102.35211624.js"><link rel="prefetch" href="/doc-vuepress/assets/js/103.a852832b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/104.d3840a25.js"><link rel="prefetch" href="/doc-vuepress/assets/js/105.bb97f57b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/106.f1ce2ff3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/107.bcc1af18.js"><link rel="prefetch" href="/doc-vuepress/assets/js/108.aea72a13.js"><link rel="prefetch" href="/doc-vuepress/assets/js/109.ea26c2b6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/11.0cc7b3fe.js"><link rel="prefetch" href="/doc-vuepress/assets/js/110.1dbc43ae.js"><link rel="prefetch" href="/doc-vuepress/assets/js/111.6c704305.js"><link rel="prefetch" href="/doc-vuepress/assets/js/112.2104312f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/113.3af2e44c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/114.83fa7f12.js"><link rel="prefetch" href="/doc-vuepress/assets/js/115.03b9877c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/116.94139d50.js"><link rel="prefetch" href="/doc-vuepress/assets/js/117.d6922e84.js"><link rel="prefetch" href="/doc-vuepress/assets/js/118.d6600176.js"><link rel="prefetch" href="/doc-vuepress/assets/js/119.6e2fc19d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/12.42e85628.js"><link rel="prefetch" href="/doc-vuepress/assets/js/120.fb904b71.js"><link rel="prefetch" href="/doc-vuepress/assets/js/121.e5418133.js"><link rel="prefetch" href="/doc-vuepress/assets/js/122.23684851.js"><link rel="prefetch" href="/doc-vuepress/assets/js/123.a2201e8f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/124.5398a4db.js"><link rel="prefetch" href="/doc-vuepress/assets/js/125.acf77852.js"><link rel="prefetch" href="/doc-vuepress/assets/js/126.8cc2a7ef.js"><link rel="prefetch" href="/doc-vuepress/assets/js/127.636078e5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/128.3dda16ec.js"><link rel="prefetch" href="/doc-vuepress/assets/js/129.76fb4160.js"><link rel="prefetch" href="/doc-vuepress/assets/js/13.22626cf9.js"><link rel="prefetch" href="/doc-vuepress/assets/js/130.4050b596.js"><link rel="prefetch" href="/doc-vuepress/assets/js/131.dcf83479.js"><link rel="prefetch" href="/doc-vuepress/assets/js/132.34df2699.js"><link rel="prefetch" href="/doc-vuepress/assets/js/133.0c2f2395.js"><link rel="prefetch" href="/doc-vuepress/assets/js/134.631acf38.js"><link rel="prefetch" href="/doc-vuepress/assets/js/135.3c7a8002.js"><link rel="prefetch" href="/doc-vuepress/assets/js/136.9d498fad.js"><link rel="prefetch" href="/doc-vuepress/assets/js/137.52b3491f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/138.2def15df.js"><link rel="prefetch" href="/doc-vuepress/assets/js/139.2027a741.js"><link rel="prefetch" href="/doc-vuepress/assets/js/14.a0e74d71.js"><link rel="prefetch" href="/doc-vuepress/assets/js/140.14025373.js"><link rel="prefetch" href="/doc-vuepress/assets/js/141.3be2fa6f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/142.7a2f26a6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/143.2226636a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/144.d6cb4516.js"><link rel="prefetch" href="/doc-vuepress/assets/js/145.cb3d04a4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/146.c2363b65.js"><link rel="prefetch" href="/doc-vuepress/assets/js/147.2d96c979.js"><link rel="prefetch" href="/doc-vuepress/assets/js/148.1932e886.js"><link rel="prefetch" href="/doc-vuepress/assets/js/149.2bb44329.js"><link rel="prefetch" href="/doc-vuepress/assets/js/15.487511b9.js"><link rel="prefetch" href="/doc-vuepress/assets/js/150.54f16e16.js"><link rel="prefetch" href="/doc-vuepress/assets/js/151.1ccddd4a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/152.c2aae540.js"><link rel="prefetch" href="/doc-vuepress/assets/js/153.818ba26e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/154.4083fc73.js"><link rel="prefetch" href="/doc-vuepress/assets/js/155.fcb284df.js"><link rel="prefetch" href="/doc-vuepress/assets/js/156.2d9dd10c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/157.2d97df21.js"><link rel="prefetch" href="/doc-vuepress/assets/js/158.b933259f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/159.127ec2ce.js"><link rel="prefetch" href="/doc-vuepress/assets/js/16.99912d5c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/160.7a9466de.js"><link rel="prefetch" href="/doc-vuepress/assets/js/161.a0965a1e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/162.9ba63ff6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/163.113f0d78.js"><link rel="prefetch" href="/doc-vuepress/assets/js/164.77e0c395.js"><link rel="prefetch" href="/doc-vuepress/assets/js/165.d4f26c88.js"><link rel="prefetch" href="/doc-vuepress/assets/js/166.a4a8a100.js"><link rel="prefetch" href="/doc-vuepress/assets/js/167.f1a4e055.js"><link rel="prefetch" href="/doc-vuepress/assets/js/168.28bca86c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/169.b99892fc.js"><link rel="prefetch" href="/doc-vuepress/assets/js/17.31966cc8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/170.0d63cca0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/171.150d95f7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/172.82820234.js"><link rel="prefetch" href="/doc-vuepress/assets/js/173.d8cdd9b8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/174.cc3e8688.js"><link rel="prefetch" href="/doc-vuepress/assets/js/175.c85fb692.js"><link rel="prefetch" href="/doc-vuepress/assets/js/176.a9864030.js"><link rel="prefetch" href="/doc-vuepress/assets/js/177.01f901aa.js"><link rel="prefetch" href="/doc-vuepress/assets/js/178.d4d7719a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/179.8e5df995.js"><link rel="prefetch" href="/doc-vuepress/assets/js/18.487740e0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/180.c283ed3a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/181.4d553ce8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/182.5f1d0255.js"><link rel="prefetch" href="/doc-vuepress/assets/js/183.bdbabf31.js"><link rel="prefetch" href="/doc-vuepress/assets/js/184.cd3a123a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/185.4f0aed34.js"><link rel="prefetch" href="/doc-vuepress/assets/js/186.1c7423c5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/187.a3260f92.js"><link rel="prefetch" href="/doc-vuepress/assets/js/188.b2b395d2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/189.c3e16d42.js"><link rel="prefetch" href="/doc-vuepress/assets/js/19.a5a43fa0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/190.0027611b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/191.5da79366.js"><link rel="prefetch" href="/doc-vuepress/assets/js/192.de572ba5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/193.e7eecd76.js"><link rel="prefetch" href="/doc-vuepress/assets/js/194.c0c9a3e1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/195.4c9e640a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/196.bca887a2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/197.32b3ef9a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/198.36dd1121.js"><link rel="prefetch" href="/doc-vuepress/assets/js/199.a7a2ea66.js"><link rel="prefetch" href="/doc-vuepress/assets/js/20.f16a556e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/200.541d2d45.js"><link rel="prefetch" href="/doc-vuepress/assets/js/201.2a6bc31e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/202.1ab0ebf7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/203.8ea83886.js"><link rel="prefetch" href="/doc-vuepress/assets/js/204.71960433.js"><link rel="prefetch" href="/doc-vuepress/assets/js/205.face6c2c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/206.edb32265.js"><link rel="prefetch" href="/doc-vuepress/assets/js/207.7edd2587.js"><link rel="prefetch" href="/doc-vuepress/assets/js/208.8eb4dd8a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/209.1e71f98c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/21.80c27c79.js"><link rel="prefetch" href="/doc-vuepress/assets/js/210.d0362700.js"><link rel="prefetch" href="/doc-vuepress/assets/js/211.ad68c64c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/212.8b718048.js"><link rel="prefetch" href="/doc-vuepress/assets/js/213.4ba985f2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/214.07f64a1f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/215.daee3c3e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/216.32992c2f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/217.7529cd64.js"><link rel="prefetch" href="/doc-vuepress/assets/js/218.0ca3a67d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/219.e61a2c40.js"><link rel="prefetch" href="/doc-vuepress/assets/js/22.c30ea85f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/220.251d745a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/221.1d95ee5c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/222.4a52a281.js"><link rel="prefetch" href="/doc-vuepress/assets/js/223.5647c4eb.js"><link rel="prefetch" href="/doc-vuepress/assets/js/224.e27da076.js"><link rel="prefetch" href="/doc-vuepress/assets/js/225.896a2b7e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/227.f7fc3384.js"><link rel="prefetch" href="/doc-vuepress/assets/js/228.3c17af77.js"><link rel="prefetch" href="/doc-vuepress/assets/js/23.b160b248.js"><link rel="prefetch" href="/doc-vuepress/assets/js/24.52ffcd3c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/25.0038c555.js"><link rel="prefetch" href="/doc-vuepress/assets/js/26.c1d32d66.js"><link rel="prefetch" href="/doc-vuepress/assets/js/27.361aa74e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/28.301d1f1b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/29.db696a70.js"><link rel="prefetch" href="/doc-vuepress/assets/js/3.618cc386.js"><link rel="prefetch" href="/doc-vuepress/assets/js/30.82c215a1.js"><link rel="prefetch" href="/doc-vuepress/assets/js/31.4218ee88.js"><link rel="prefetch" href="/doc-vuepress/assets/js/32.185a0605.js"><link rel="prefetch" href="/doc-vuepress/assets/js/33.8e56a2c2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/34.e93b30c8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/35.c029905f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/36.3c26314a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/37.281e9bbf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/38.95142af3.js"><link rel="prefetch" href="/doc-vuepress/assets/js/39.7b46210b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/4.ab196059.js"><link rel="prefetch" href="/doc-vuepress/assets/js/40.da793450.js"><link rel="prefetch" href="/doc-vuepress/assets/js/41.ae5d114c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/42.6092d6fd.js"><link rel="prefetch" href="/doc-vuepress/assets/js/43.3676ecec.js"><link rel="prefetch" href="/doc-vuepress/assets/js/44.604dee90.js"><link rel="prefetch" href="/doc-vuepress/assets/js/45.ef7b2563.js"><link rel="prefetch" href="/doc-vuepress/assets/js/46.5126b263.js"><link rel="prefetch" href="/doc-vuepress/assets/js/47.15c9fa2f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/48.4d000b30.js"><link rel="prefetch" href="/doc-vuepress/assets/js/49.c04122ec.js"><link rel="prefetch" href="/doc-vuepress/assets/js/5.61dedc87.js"><link rel="prefetch" href="/doc-vuepress/assets/js/50.b36b2268.js"><link rel="prefetch" href="/doc-vuepress/assets/js/51.38b2e042.js"><link rel="prefetch" href="/doc-vuepress/assets/js/52.fa2688bf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/53.8e7b4e2a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/54.cc60f637.js"><link rel="prefetch" href="/doc-vuepress/assets/js/55.c593a0bd.js"><link rel="prefetch" href="/doc-vuepress/assets/js/56.b92ff64e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/57.0127b901.js"><link rel="prefetch" href="/doc-vuepress/assets/js/58.b51e39e7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/59.4656872e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/6.7862f44a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/60.0b84f136.js"><link rel="prefetch" href="/doc-vuepress/assets/js/61.77bb1c42.js"><link rel="prefetch" href="/doc-vuepress/assets/js/62.255b2396.js"><link rel="prefetch" href="/doc-vuepress/assets/js/63.0784c59f.js"><link rel="prefetch" href="/doc-vuepress/assets/js/64.bfd10989.js"><link rel="prefetch" href="/doc-vuepress/assets/js/65.271e0fe0.js"><link rel="prefetch" href="/doc-vuepress/assets/js/66.37d35e9b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/67.1f723e6e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/68.1d6b4d62.js"><link rel="prefetch" href="/doc-vuepress/assets/js/69.751866f7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/7.16153ad4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/70.5a176ed9.js"><link rel="prefetch" href="/doc-vuepress/assets/js/71.cefafd88.js"><link rel="prefetch" href="/doc-vuepress/assets/js/72.89cf0ee7.js"><link rel="prefetch" href="/doc-vuepress/assets/js/73.7ae1caa5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/74.3a0426c5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/75.346a5b12.js"><link rel="prefetch" href="/doc-vuepress/assets/js/76.40d6b949.js"><link rel="prefetch" href="/doc-vuepress/assets/js/77.af42e53e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/78.a1a1041d.js"><link rel="prefetch" href="/doc-vuepress/assets/js/79.3979b3e2.js"><link rel="prefetch" href="/doc-vuepress/assets/js/8.51f8b48e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/80.ddedd06c.js"><link rel="prefetch" href="/doc-vuepress/assets/js/81.f47899f4.js"><link rel="prefetch" href="/doc-vuepress/assets/js/82.b64b79c5.js"><link rel="prefetch" href="/doc-vuepress/assets/js/83.3d3b0dd8.js"><link rel="prefetch" href="/doc-vuepress/assets/js/84.f20ba61e.js"><link rel="prefetch" href="/doc-vuepress/assets/js/85.3a85fe1a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/86.a2c68016.js"><link rel="prefetch" href="/doc-vuepress/assets/js/87.e498e9cf.js"><link rel="prefetch" href="/doc-vuepress/assets/js/88.16da169b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/89.dfdd9486.js"><link rel="prefetch" href="/doc-vuepress/assets/js/9.b89c29c6.js"><link rel="prefetch" href="/doc-vuepress/assets/js/90.9dfc4480.js"><link rel="prefetch" href="/doc-vuepress/assets/js/91.29fae888.js"><link rel="prefetch" href="/doc-vuepress/assets/js/92.3a2f5266.js"><link rel="prefetch" href="/doc-vuepress/assets/js/93.2a30db4b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/94.d73d493b.js"><link rel="prefetch" href="/doc-vuepress/assets/js/95.4675d725.js"><link rel="prefetch" href="/doc-vuepress/assets/js/96.ba849b11.js"><link rel="prefetch" href="/doc-vuepress/assets/js/97.167b1f35.js"><link rel="prefetch" href="/doc-vuepress/assets/js/98.cd43851a.js"><link rel="prefetch" href="/doc-vuepress/assets/js/99.6b57d9c5.js">
    <link rel="stylesheet" href="/doc-vuepress/assets/css/0.styles.f3cbd881.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Chiriri</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc-vuepress/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaSE/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaEE/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/SQL/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/机器学习/" class="nav-link">
  机器学习
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Python模块/" class="nav-link">
  Python模块
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Flume/" class="nav-link">
  Flume
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Kafka/" class="nav-link">
  Kafka
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/前端/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc-vuepress/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaSE/" class="nav-link">
  JavaSE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/JavaEE/" class="nav-link">
  JavaEE
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/SQL/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/机器学习/" class="nav-link">
  机器学习
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Python模块/" class="nav-link">
  Python模块
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Flume/" class="nav-link">
  Flume
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Kafka/" class="nav-link">
  Kafka
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc-vuepress/前端/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/doc-vuepress/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/doc-vuepress/机器学习/matplotlib.html" class="sidebar-link">matplotlib</a></li><li><a href="/doc-vuepress/机器学习/Numpy.html" class="sidebar-link">Numpy</a></li><li><a href="/doc-vuepress/机器学习/Pandas.html" class="active sidebar-link">Pandas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#series" class="sidebar-link">Series</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#创建" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#属性" class="sidebar-link">属性</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#dataframe" class="sidebar-link">DataFrame</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#创建-2" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#属性和查看" class="sidebar-link">属性和查看</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#列名修改" class="sidebar-link">列名修改</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#单元格操作" class="sidebar-link">单元格操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#读取" class="sidebar-link">读取</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#赋值" class="sidebar-link">赋值</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#替换值" class="sidebar-link">替换值</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#索引重置和设置" class="sidebar-link">索引重置和设置</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#增加列和行" class="sidebar-link">增加列和行</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#删除列或行" class="sidebar-link">删除列或行</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#排序" class="sidebar-link">排序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#dataframe-2" class="sidebar-link">DataFrame</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#series-2" class="sidebar-link">Series</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#运算" class="sidebar-link">运算</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#数据筛选" class="sidebar-link">数据筛选</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#筛选列" class="sidebar-link">筛选列</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#筛选行" class="sidebar-link">筛选行</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#组合" class="sidebar-link">组合</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#自定义函数" class="sidebar-link">自定义函数</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#pandas画图" class="sidebar-link">Pandas画图</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#读取和保存" class="sidebar-link">读取和保存</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#set-option-选择设置" class="sidebar-link">set_option 选择设置</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#reset-option" class="sidebar-link">reset_option</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#style" class="sidebar-link">style</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#缺失值处理" class="sidebar-link">缺失值处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#判断缺失值" class="sidebar-link">判断缺失值</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#替换和替换缺失值或标记值" class="sidebar-link">替换和替换缺失值或标记值</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#缺失值转换" class="sidebar-link">缺失值转换</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#缺失值标记" class="sidebar-link">缺失值标记</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#缺失值忽略" class="sidebar-link">缺失值忽略</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#数据离散化" class="sidebar-link">数据离散化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#one-hot编码" class="sidebar-link">one-hot编码</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#数据合并" class="sidebar-link">数据合并</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#concat" class="sidebar-link">concat</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#merge" class="sidebar-link">merge</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#join-组合" class="sidebar-link">join 组合</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#交叉表与透视表" class="sidebar-link">交叉表与透视表</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#分组与聚合" class="sidebar-link">分组与聚合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#分组可视化" class="sidebar-link">分组可视化</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#时间处理" class="sidebar-link">时间处理</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#去重" class="sidebar-link">去重</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#热力图" class="sidebar-link">热力图</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#热力地图" class="sidebar-link">热力地图</a></li><li class="sidebar-sub-header"><a href="/doc-vuepress/机器学习/Pandas.html#直方图" class="sidebar-link">直方图</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pandas"><a href="#pandas" class="header-anchor">#</a> Pandas</h1> <p>Pandas 以Numpy为基础 和 matplotlib   开源的数据挖掘库 用于数据探索</p> <h2 id="series"><a href="#series" class="header-anchor">#</a> Series</h2> <p>Series是一个类似于一维数组的数据结构，它能够保存任何类型的数据，比如整数、字符串、浮点数等，主要由一组数据和与之相关的索引两
部分构成</p> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211102212956204.png" alt="image-20211102212956204"></p> <h3 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h3> <ul><li><p>pd.Series(data=None, index=None, dtype=None)</p> <ul><li>data：传入的数据，可以是ndarray、list等</li> <li>index：索引，必须是唯一的，且与数据的长度相等。如果没有传入索引参数，则默认会自动创建一个从0-N的整数索引。</li> <li>dtype：数据的类型</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>指定索引</p> <div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6.7</span><span class="token punctuation">,</span><span class="token number">5.6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>通过字典创建</p> <div class="language-python extra-class"><pre class="language-python"><code>color_count <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'red'</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">'yellow'</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h3 id="属性"><a href="#属性" class="header-anchor">#</a> 属性</h3> <ul><li>color_count.index   返回行索引</li> <li>color_count.values   返回一个np数组 存放为列值</li> <li>color_count.tolist()  返回一个np数组 存放为列值</li> <li>color_count[n]  通过索引来获取值</li></ul> <h2 id="dataframe"><a href="#dataframe" class="header-anchor">#</a> DataFrame</h2> <p>DataFrame是一个类似于二维数组或表格(如excel)的对象，既有行索引，又有列索引</p> <ol><li>行索引，表明不同行，横向索引，叫index，0轴，axis=0</li> <li>列索引，表名不同列，纵向索引，叫columns，1轴，axis=1</li></ol> <h3 id="创建-2"><a href="#创建-2" class="header-anchor">#</a> 创建</h3> <ul><li><p>创建DataFrame 需要传递一个ndarray对象</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>stock_change <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#导入np数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>stock_change<span class="token punctuation">)</span>
<span class="token comment">#根据行数生成行索引</span>
stock_code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;股票{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>stock_rise<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">#修改行索引名称</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>stock_change<span class="token punctuation">,</span>index<span class="token operator">=</span>stock_code<span class="token punctuation">)</span>
<span class="token comment">#生成时间序列</span>
<span class="token comment">#date_range(start=None,end=None,periods=None,freq=&quot;B&quot;)</span>
<span class="token comment">#start开始时间 end结束时间 periods时间天数 freq递进单位默认为一台   B为略过周末</span>
date <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">&quot;20211020&quot;</span><span class="token punctuation">,</span>periods<span class="token operator">=</span>stock_rise<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>freq<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span>

<span class="token comment">#添加列索引名称</span>
stock_c <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>stock_change<span class="token punctuation">,</span>index<span class="token operator">=</span>stock_code<span class="token punctuation">,</span>columns<span class="token operator">=</span>date<span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>增加行、列索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 构造行索引序列</span>
subjects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;语文&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;数学&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;英语&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;政治&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;体育&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># 构造列索引序列</span>
stu <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'同学'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>score_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 添加行索引</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>score<span class="token punctuation">,</span> columns<span class="token operator">=</span>subjects<span class="token punctuation">,</span> index<span class="token operator">=</span>stu<span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h3 id="属性和查看"><a href="#属性和查看" class="header-anchor">#</a> 属性和查看</h3> <ul><li><p>df.shape    查看几行几列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#查看几行几列</span>
stock_rise<span class="token punctuation">.</span>shape
<span class="token comment">#查看行</span>
stock_rise<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment">#查看列</span>
stock_rise<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li> <li><p>df.index  查询行索引列表</p></li> <li><p>df.columns   查看当前df的列名列表</p></li> <li><p>df.values  查询所有数据  返回为一个np数组</p></li> <li><p>df.sample(n)  随机查看n条数据  默认为1条</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>df.head()  查看前5行 可传递指定行数</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>df.tail()  后5行 可传递指定行数</p></li> <li><p>df.info()  查看数据基本信息</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.frame.DataFrame'</span><span class="token operator">&gt;</span>
RangeIndex<span class="token punctuation">:</span> <span class="token number">262</span> entries<span class="token punctuation">,</span> <span class="token number">0</span> to <span class="token number">261</span>
Data columns <span class="token punctuation">(</span>total <span class="token number">11</span> columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
 <span class="token comment">#   Column  Non-Null Count  Dtype  </span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>  
 <span class="token number">0</span>   片名      <span class="token number">262</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">1</span>   上映年份    <span class="token number">262</span> non<span class="token operator">-</span>null    int64  
 <span class="token number">2</span>   评分      <span class="token number">257</span> non<span class="token operator">-</span>null    float64
 <span class="token number">3</span>   评价人数    <span class="token number">259</span> non<span class="token operator">-</span>null    float64
 <span class="token number">4</span>   导演      <span class="token number">262</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">5</span>   编剧      <span class="token number">262</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">6</span>   主演      <span class="token number">262</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">7</span>   类型      <span class="token number">262</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">8</span>   国家<span class="token operator">/</span>地区   <span class="token number">256</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">9</span>   语言      <span class="token number">256</span> non<span class="token operator">-</span>null    <span class="token builtin">object</span> 
 <span class="token number">10</span>  时长<span class="token punctuation">(</span>分钟<span class="token punctuation">)</span>  <span class="token number">256</span> non<span class="token operator">-</span>null    float64
dtypes<span class="token punctuation">:</span> float64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> int64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">object</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
memory usage<span class="token punctuation">:</span> <span class="token number">22.6</span><span class="token operator">+</span> KB
</code></pre></div></li></ul></li> <li><p>df.describe()  查看数据统计信息｜整体</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">)</span>  <span class="token comment">#默认不包含 unique去重后数据量  top出现频率最高的  freq频率计数</span>
df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T <span class="token comment">#保留2为小数 并进行行列互换 方便查看</span>
</code></pre></div></li> <li><p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211105210745645.png" alt="image-20211105210745645"></p></li></ul></li> <li><p>df.dtypes  查看各列数据类型</p></li> <li><p>df.corr()   相关系数矩阵，也就是每两列之间的相关性系数</p></li> <li><p>df支持切片</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li> <li><p>df.T  行列互换</p></li></ul> <h2 id="列名修改"><a href="#列名修改" class="header-anchor">#</a> 列名修改</h2> <ul><li>df.columns=[&quot;1&quot;,&quot;2&quot;]   将全部列设置为指定列表</li> <li>df.rename(columns={&quot;a&quot;,&quot;A&quot;,&quot;b&quot;,&quot;B&quot;},inplace=True)   替换指定列
<ul><li>columns:列名 如传递一个数组则需要与csv文件中列名数保持一致  如果传递为map则将指定列名替换为值 {&quot;positionId&quot;:&quot;ID&quot;,&quot;positionName&quot;:&quot;岗位名称&quot;,&quot;salary&quot;:&quot;薪资&quot;}</li> <li>inplace: 是否替换原dataframe 默认为false</li></ul></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;positionId&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;positionName&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;岗位名称&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;薪资&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="单元格操作"><a href="#单元格操作" class="header-anchor">#</a> 单元格操作</h2> <h3 id="读取"><a href="#读取" class="header-anchor">#</a> 读取</h3> <ul><li><p>df[&quot;列名&quot;][&quot;行索引&quot;]  df中默认是<strong>先列后行</strong>  不支持切片  如果单列则支持索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span><span class="token string">'open'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'2018-02-27'</span><span class="token punctuation">]</span> <span class="token comment">#先列后行  不支持切片</span>
data<span class="token punctuation">[</span><span class="token string">'open'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">#单列 支持切片</span>
</code></pre></div></li></ul></li> <li><p>df.loc[&quot;2018-02-27&quot;:&quot;2018-02-23&quot;,&quot;high&quot;]    通过loc 索引名称 实现<strong>先行后列</strong>的查询  <strong>支持切片</strong></p></li> <li><p>df.iloc[行下标,列下标] 通过索引下标值  支持切片</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>stock_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
stock_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li> <li><p>df.at[&quot;行索引&quot;,&quot;列名&quot;]  at先行后列的查询</p></li> <li><p>多列名读取</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;positionId&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;companyId&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;industryField&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li></ul> <h3 id="赋值"><a href="#赋值" class="header-anchor">#</a> 赋值</h3> <ul><li><p>指定列赋值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
data<span class="token punctuation">.</span>close <span class="token operator">=</span> <span class="token number">1</span>
df<span class="token punctuation">[</span><span class="token string">&quot;金牌大于30&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string">&quot;是&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;否&quot;</span><span class="token punctuation">)</span> <span class="token comment">#支持比较</span>
</code></pre></div></li></ul></li> <li><p>指定单元格赋值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>stock_data<span class="token punctuation">[</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;2018-02-27&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;国家奥委会&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;俄奥委会&quot;</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;俄奥委会&quot;</span>
</code></pre></div></li></ul></li></ul> <h3 id="替换值"><a href="#替换值" class="header-anchor">#</a> 替换值</h3> <ul><li><p>df.replace(&quot;指定值&quot;,&quot;替换值&quot;,inplace=True)</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;无&quot;</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#整个df替换</span>
df<span class="token punctuation">[</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;无&quot;</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#替换值（多值）</span>
df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;无&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;None&quot;</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="索引重置和设置"><a href="#索引重置和设置" class="header-anchor">#</a> 索引重置和设置</h2> <ul><li><p>修改索引 传递一个相同个数的列表   可以获取下标获取值但<strong>不能单个修改</strong></p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>stu <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;学生_&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>score_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 必须整体全部修改</span>
data<span class="token punctuation">.</span>index <span class="token operator">=</span> stu
<span class="token comment">#索引可以通过下标获取 但无法直接进行修改</span>
<span class="token comment">#stu.index[3] </span>
</code></pre></div></li></ul></li> <li><p>reset_index(drop=False)  重置索引  drop默认为Flase不删除原来索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 重置索引,drop=False  默认保留旧索引</span>
data<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 重置索引,drop=True</span>
data<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>set_index(keys,drop = True)以某列值设置为新的索引  keys列名或列索引  drop默认为true 删除原来的索引列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&quot;year&quot;</span><span class="token punctuation">)</span> <span class="token comment">#以某列设置为新的索引</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;year&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;month&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#设置多个索引</span>
</code></pre></div></li></ul></li> <li><p>df.rename_axis(keys,inplace=True)  更改当前索引列名</p> <ul><li><div class="language-py extra-class"><pre class="language-py"><code>df<span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token string">&quot;金牌排名&quot;</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>df.set_index(&quot;列名&quot;,inplace=True)  将指定列设定为索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&quot;排名&quot;</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;排名&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;总分&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#支持多列行索引</span>
</code></pre></div></li></ul></li> <li><p>df.reindex([&quot;索引名1&quot;,&quot;索引名2&quot;,...])  将索引重置为指定索引列表</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df4<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>df1<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="增加列和行"><a href="#增加列和行" class="header-anchor">#</a> 增加列和行</h2> <ul><li>增加列 直接df引用未定的列名 自动创建</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token string">&quot;比赛地点&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;东京&quot;</span>
</code></pre></div><ul><li><p>在最后一行增加行 使用append</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
df_new <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>在指定行中 增加行  使用concat</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
df2 <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
df_new <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df3<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>








</code></pre></div></li></ul></li></ul> <h2 id="删除列或行"><a href="#删除列或行" class="header-anchor">#</a> 删除列或行</h2> <ul><li><p>df.drop(columns,axis=0)  删除列或行 传递指定行索引名或者列名</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#删除索引名为1的行</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>金牌数<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span> <span class="token comment">#条件删除</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ma5'</span><span class="token punctuation">,</span> <span class="token string">'ma10'</span><span class="token punctuation">,</span> <span class="token string">'ma20'</span><span class="token punctuation">,</span> <span class="token string">'v_ma5'</span><span class="token punctuation">,</span> <span class="token string">'v_ma10'</span><span class="token punctuation">,</span> <span class="token string">'v_ma20'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token comment">#删除多个列</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;比赛地点&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#删除指定列</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#按列号删除</span>

</code></pre></div></li></ul></li></ul> <h2 id="排序"><a href="#排序" class="header-anchor">#</a> 排序</h2> <h3 id="dataframe-2"><a href="#dataframe-2" class="header-anchor">#</a> DataFrame</h3> <ul><li><p>df.sort_values(by=, ascending=)   按列的值排序   by: 列名    ascending: 默认为True升序 False降序</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">#升序</span>
data<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token string">'high'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment">#多个列降序</span>
</code></pre></div></li></ul></li> <li><p>df.sort_index()    根据索引进行排序 默认升序</p></li></ul> <h3 id="series-2"><a href="#series-2" class="header-anchor">#</a> Series</h3> <ul><li><p>series.sort_values(ascending=True)    对series中的值进行排序 默认升序</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span><span class="token string">'p_change'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>series.sort_index()   索引排序</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span><span class="token string">'p_change'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="运算"><a href="#运算" class="header-anchor">#</a> 运算</h2> <ul><li><p>data.add   相加    data['open'].add(1)</p></li> <li><p>逻辑运算</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">23</span><span class="token punctuation">]</span>
data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># 支持逻辑运算符</span>
</code></pre></div></li></ul></li> <li><p>data.query(expr)   逻辑运算函数</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;open&lt;24 &amp; open&gt;23&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 只需要根据列名 + 条件就可以判断</span>
</code></pre></div></li></ul></li> <li><p>data.isin(values)   判断值是否在指定范围</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">23.53</span><span class="token punctuation">,</span> <span class="token number">23.85</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li> <li><p>data.agg() 进行聚合操作 支持自定义min max mead sum等操作</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;总分&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;median&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mean&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;高端人才得分&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;median&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mean&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;办学层次得分&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;median&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mean&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>data.max(0)   最大值  默认为列计算 axis=0  传递1为行计算</p></li> <li><p>data.min()   最小值</p></li> <li><p>data.std()   标准差</p></li> <li><p>data.var()  方差</p></li> <li><p>data.median()  中位数</p></li> <li><p>data.quantile()  分位数 默认返回50%的分位数 即中位数</p></li> <li><p>data.idxmax(axis=0)   最大值的索引名</p></li> <li><p>data.idxmin(axis=0)   最小值的索引名</p></li> <li><p>data.cumsum()   连续求和 累加到最后一个单元格</p></li> <li><p>data.cummax()  计算最大值</p></li> <li><p>data.cummin()   计算最小值</p></li> <li><p>data.cumprod()   累乘</p></li> <li><p>data.mode()  众数</p></li> <li><p>data.nsmallest(n)  返回当前列最小的n个数</p></li> <li><p>data.nlargest(n)  返回当前列最大的n个数</p></li></ul> <h2 id="数据筛选"><a href="#数据筛选" class="header-anchor">#</a> 数据筛选</h2> <h3 id="筛选列"><a href="#筛选列" class="header-anchor">#</a> 筛选列</h3> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment">#通过列号筛选</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">,</span><span class="token string">'银牌数'</span><span class="token punctuation">,</span><span class="token string">'铜牌数'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#通过列名</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#条件筛选</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'数'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">#提取全部列名中包含 数 的列</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">#组合（行号+列名） 提取倒数后三列的10-20行</span>
</code></pre></div><h3 id="筛选行"><a href="#筛选行" class="header-anchor">#</a> 筛选行</h3> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token comment"># 通过行号</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">#切片</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment"># 步进</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">]</span> <span class="token comment"># 判断</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">]</span> 
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 条件</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'国家奥委会'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'中国'</span><span class="token punctuation">,</span><span class="token string">'美国'</span><span class="token punctuation">,</span><span class="token string">'英国'</span><span class="token punctuation">,</span><span class="token string">'日本'</span><span class="token punctuation">,</span><span class="token string">'巴西'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 判断是否在列表中的值 </span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df<span class="token punctuation">[</span><span class="token string">'国家奥委会'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'中国'</span><span class="token punctuation">,</span> <span class="token string">'美国'</span><span class="token punctuation">,</span> <span class="token string">'英国'</span><span class="token punctuation">,</span> <span class="token string">'日本'</span><span class="token punctuation">,</span> <span class="token string">'巴西'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">#多条件  每个条件要用括号包起来</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>国家奥委会<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'国'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 提取 国家奥委会 列中，所有包含 国的行</span>
</code></pre></div><h3 id="组合"><a href="#组合" class="header-anchor">#</a> 组合</h3> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 第 0 行第 2 列</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">#筛选多行多列</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">#行号+列号</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span> <span class="token comment"># 行号+列名</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'国家奥委会'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'中国'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span> <span class="token comment"># 条件</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;金牌数 + 银牌数 &gt; 15&quot;</span><span class="token punctuation">)</span> <span class="token comment"># query 类sql筛选</span>

<span class="token comment">#query（引用变量）</span>
me <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;金牌数&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;金牌数 &gt; </span><span class="token interpolation"><span class="token punctuation">{</span>me<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment">#需要要{}引用变量  类sql语句</span>



</code></pre></div><h2 id="自定义函数"><a href="#自定义函数" class="header-anchor">#</a> 自定义函数</h2> <ul><li><p>df.apply(自定义函数名,axis=0)  df会传递一个Series对象  通过自定义函数return一个结果   axis=0:默认是列，axis=1为行进行运算</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">abc</span><span class="token punctuation">(</span>ses<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c_null <span class="token operator">=</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>ses<span class="token punctuation">)</span>
    is_null <span class="token operator">=</span> column<span class="token punctuation">[</span>c_null<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>is_null<span class="token punctuation">)</span>

df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>abc<span class="token punctuation">)</span>  <span class="token comment">#会返回每一列null的个数</span>
</code></pre></div></li></ul></li></ul> <h2 id="pandas画图"><a href="#pandas画图" class="header-anchor">#</a> Pandas画图</h2> <ul><li>df.plot  (kind='line')   默认为line折线图
<ul><li>line 折线图</li> <li>bar 柱状图</li> <li>barh   横向直方图</li> <li>hist    直方图</li> <li>pie 饼图</li> <li>scatter  散点图</li></ul></li></ul> <h2 id="读取和保存"><a href="#读取和保存" class="header-anchor">#</a> 读取和保存</h2> <ul><li><p>pd.read_csv(filepath_or_buffer, sep =',', usecols=[1,3,5],skiprows=[1,3,5],index_col=[&quot;列名&quot;],names=[], keep_default_na=False,na_values=['[]'],na_filter= True,dtype={'positionId': str,'companyId':str})</p> <ul><li><p>filepath_or_buffer:文件路径</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>sep :分隔符，默认用&quot;,&quot;隔开</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>usecols:指定读取的列名，列表形式  [1,3,5]  只读取2 4 6列  或指定列名 ['positionId','positionName','salary']</p> <ul><li><div class="language-py extra-class"><pre class="language-py"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>usecols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'positionId'</span><span class="token punctuation">,</span><span class="token string">'positionName'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>usecols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>skiprows: 跳过指定行数 [1,3,5]  跳过 2 4 6 行</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>skiprows <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>index_col: 将指定列设置为行索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>index_col<span class="token operator">=</span><span class="token string">&quot;positionId&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>names: 指定新的列名 ['ID','岗位名称','薪资']   <strong>不支持map</strong></p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'ID'</span><span class="token punctuation">,</span><span class="token string">'岗位名称'</span><span class="token punctuation">,</span><span class="token string">'薪资'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>keep_default_na: 缺失值标记为NaN 默认为True</p></li> <li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> keep_default_na<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>na_values: 将缺失值标记为指定字符串    如['[]']</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span>na_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'[]'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>na_filter:  缺失值是否处理 默认为True 处理</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>na_filter<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>dtype: 读取时指定列类型  传递map</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'positionId'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span><span class="token string">'companyId'</span><span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre></div></li></ul></li> <li><p>parse_dates: 将指定列转为datatime类型</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>parse_dates<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'createTime'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
</code></pre></div></li></ul></li> <li><p>chunksize: 分块读取  返回一个可迭代对象，每次读取 n 行</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span> chunksize<span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul></li> <li><p>df.to_csv(path_or_buf=None, sep=', ’, columns=None, header=True, index=True, mode='w', encoding=None)</p> <ul><li><p>path_or_buf :文件路径</p></li> <li><p>sep :分隔符，默认用&quot;,&quot;隔开</p></li> <li><p>columns :选择需要的列索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;234.csv&quot;</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;positionName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>header :boolean or list of string, default True,是否写进列索引值</p></li> <li><p>index:是否写进行索引</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;234.csv&quot;</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment">#不写入索引</span>
</code></pre></div></li></ul></li> <li><p>mode:'w'：重写, 'a' 追加</p></li> <li><p>na_rep: 缺失值标记为指定字符</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;234.csv&quot;</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>na_rep<span class="token operator">=</span><span class="token string">&quot;数据缺失&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul></li> <li><p>pd.read_hdf(path_or_buf，key =None)</p> <ul><li>path_or_buffer:文件路径</li> <li>key:读取的键</li> <li>需要先安装tables库      pip install tables</li></ul></li> <li><p>df.to_hdf(path_or_buf, key)</p></li> <li><p>pd.read_json(&quot;./data//test.json&quot;,orient=&quot;records&quot;,lines=True)   orient指定列  lines是否一行一个数据默认为false 一行一大串数据 推荐设置为true</p></li> <li><p>df.to_json(&quot;./data/test.json&quot;,orient=&quot;close&quot;)</p></li> <li><p>pd.read_clipboard()   从剪贴板读取数据</p></li> <li><p>pd.read_sql(sql语句,conn连接对象)</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sqlite3 <span class="token keyword">import</span> connect
conn <span class="token operator">=</span> connect<span class="token punctuation">(</span><span class="token string">':memory:'</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&quot;SELECT int_column, date_column FROM test_data&quot;</span><span class="token punctuation">,</span>conn<span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="set-option-选择设置"><a href="#set-option-选择设置" class="header-anchor">#</a> set_option 选择设置</h2> <p>option 选择设置为全局配置</p> <ul><li><p>display.max_columns  显示全部列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment">#显示全部列</span>
</code></pre></div></li></ul></li> <li><p>display.max_columns 显示指定列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>  
</code></pre></div></li></ul></li> <li><p>display.max_rows 显示指定行</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>display.max_colwidth  每列最多显示10个字符，多余的会变成...   设置指定长度字符</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option <span class="token punctuation">(</span><span class="token string">'display.max_colwidth'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>precision 修改默认显示精度为小数点后5位</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>mode.chained_assignment  取消pandas相关warning提示</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;mode.chained_assignment&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span> 
<span class="token comment"># 全局取消warning</span>
<span class="token comment"># import warnings</span>
<span class="token comment"># warnings.filterwarnings('ignore')</span>
</code></pre></div></li></ul></li> <li><p>chop_threshold 数值显示条件  如果数值小于 20 则显示为0</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'chop_threshold'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> 
</code></pre></div></li></ul></li> <li><p>display.html.use_mathjax  让dataframe中内容支持 Latex 显示（需要使用$$包住）</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;display.html.use_mathjax&quot;</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>plotting.backend  修改绘图引擎</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#修改pandas默认绘图引擎为plotly（需要提前安装好plotly）</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;plotting.backend&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;plotly&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h2 id="reset-option"><a href="#reset-option" class="header-anchor">#</a> reset_option</h2> <ul><li><p>根据key还原指定选择设置 去除display.</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>reset_option<span class="token punctuation">(</span><span class="token string">&quot;max_rows&quot;</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>reset_option<span class="token punctuation">(</span><span class="token string">&quot;max_columns&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>还原全部显示设置  display</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>reset_option<span class="token punctuation">(</span><span class="token string">&quot;^display&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>还原全部 option 设置</p> <ul><li><div class="language-py extra-class"><pre class="language-py"><code>pd<span class="token punctuation">.</span>reset_option<span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">)</span> 





</code></pre></div></li></ul></li></ul> <h2 id="style"><a href="#style" class="header-anchor">#</a> style</h2> <p>基于 style 个性化设置同样不会修改数据，所有 data.style.xxxx 输出的数据均是一次性的（可以复用、导出），因此你应该在合适的时间选择使用该方法。</p> <ul><li><p>style.hide_index()  隐藏索引列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>hide_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.set_precision(n)  调整小数的精度</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 将带有小数点的列精度调整为小数点后2位</span>
data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>set_precision<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre></div></li></ul></li> <li><p>style.set_na_rep(&quot;指定字符&quot;)  标记缺失值为指定字符</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>set_na_rep<span class="token punctuation">(</span><span class="token string">&quot;数据缺失&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.highlight_null(null_color=&quot;red&quot;)  高亮缺失值</p> <ul><li><p>null_color: 为高亮颜色 默认为红色</p></li> <li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>set_na_rep<span class="token punctuation">(</span><span class="token string">&quot;数据缺失&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>highlight_null<span class="token punctuation">(</span>null_color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.highlight_max  高亮数值列最大值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_max<span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.highlight_min  高亮数值列最小值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_min<span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>同时高亮最大最小值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>highlight_max<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'#F77802'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>highlight_min<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">'#26BE49'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.highlight_between  设置指定列 指定范围内高亮</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>highlight_between<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.background_gradient 渐变显示数值列</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

cm <span class="token operator">=</span> sns<span class="token punctuation">.</span>light_palette<span class="token punctuation">(</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span> as_cmap<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>cmap<span class="token operator">=</span>cm<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div></li></ul></li> <li><p>style.set_properties  修改指定properties</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 修改字体颜色</span>
<span class="token comment"># 将 salary 列修改为红色字体</span>
<span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span>
    subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#修改背景颜色、对齐方式、字体大小</span>
<span class="token comment">#1.居中 2.背景色修改为 #F8F8FF 3.字体:13px</span>
<span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'background-color'</span><span class="token punctuation">:</span> <span class="token string">'#F8F8FF'</span><span class="token punctuation">,</span><span class="token string">'text-align'</span><span class="token punctuation">:</span><span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token string">'font-size'</span><span class="token punctuation">:</span> <span class="token string">'13px'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#链式多个设置进行结合</span>
<span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'background-color'</span><span class="token punctuation">:</span> <span class="token string">'#F8F8FF'</span><span class="token punctuation">,</span><span class="token string">'text-align'</span><span class="token punctuation">:</span><span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token string">'font-size'</span><span class="token punctuation">:</span> <span class="token string">'13px'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span>
    subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>带样式导出</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'background-color'</span><span class="token punctuation">:</span> <span class="token string">'#F8F8FF'</span><span class="token punctuation">,</span><span class="token string">'text-align'</span><span class="token punctuation">:</span><span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token string">'font-size'</span><span class="token punctuation">:</span> <span class="token string">'13px'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>set_properties<span class="token punctuation">(</span>
    subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'带有样式导出.xlsx'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.bar  将指定列以横向条形图形式进行可视化</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.applymap  带条件样式 / 自定义样式</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_style</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>

    color <span class="token operator">=</span> <span class="token string">'red'</span> <span class="token keyword">if</span> val <span class="token operator">&gt;</span> <span class="token number">30000</span> <span class="token keyword">else</span> <span class="token string">'black'</span>
    <span class="token keyword">return</span> <span class="token string">'color: %s'</span> <span class="token operator">%</span> color


data<span class="token punctuation">.</span>style<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span>my_style<span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>style.format 格式化值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#将 createTime 列格式化输出为 xx年xx月xx日</span>
data<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> t<span class="token punctuation">:</span> t<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y年%m月%d日&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">#1.在 salary 列后增加&quot;元&quot;  2.对 matchScore 列保留两位小数并增加&quot;分&quot;</span>
<span class="token punctuation">(</span>data
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;{0:,.2f}分&quot;</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token string">&quot;matchScore&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;{&quot;</span><span class="token string">&quot;}元&quot;</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li></li></ul> <h2 id="缺失值处理"><a href="#缺失值处理" class="header-anchor">#</a> 缺失值处理</h2> <h3 id="判断缺失值"><a href="#判断缺失值" class="header-anchor">#</a> 判断缺失值</h3> <ul><li><p>type(np.NaN)  默认为float类型</p></li> <li><p>pd.isnull(df)  判断df 是否有Nan 如有则返回True</p> <ul><li><p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211103093020199.png" alt="image-20211103093020199"></p></li> <li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#查询每列Nan的数量</span>
df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

片名        <span class="token number">0</span>
上映年份      <span class="token number">0</span>
评分        <span class="token number">5</span>
评价人数      <span class="token number">3</span>
导演        <span class="token number">0</span>
编剧        <span class="token number">0</span>
主演        <span class="token number">0</span>
类型        <span class="token number">0</span>
国家<span class="token operator">/</span>地区     <span class="token number">6</span>
语言        <span class="token number">6</span>
时长<span class="token punctuation">(</span>分钟<span class="token punctuation">)</span>    <span class="token number">6</span>
dtype<span class="token punctuation">:</span> int64
    
<span class="token comment">#统计df中所有nan值</span>
df<span class="token punctuation">.</span>isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>pd.notnull(df)  判断df 是否有Nan 如有则返回False</p></li> <li><p>np.all(pd.notnull(movie))    里面如果有一个缺失值 则为false 则返回false</p></li> <li><p>np.any(pd.isnull(movie))     通过np.any 只有里面有一个为null就返回true</p></li> <li><p>高亮缺失值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">]</span>
<span class="token punctuation">.</span>style
<span class="token punctuation">.</span>highlight_null<span class="token punctuation">(</span>null_color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h3 id="替换和替换缺失值或标记值"><a href="#替换和替换缺失值或标记值" class="header-anchor">#</a> 替换和替换缺失值或标记值</h3> <ul><li><p>df.dropna()   删除所有np.Nan 直接删除一行数据</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#按行删除</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;列名1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;列名2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#删除指定列中的缺失值</span>
</code></pre></div></li></ul></li> <li><p>df.fillna(value, inplace=False)    替换所有的缺失值为指定值</p> <ul><li><p>value:缺失值将要替换成的值</p></li> <li><p>inplace:True:会修改原数据，默认为False:不替换修改原数据，生成新的对象</p></li> <li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#可以替换单列</span>
movie<span class="token punctuation">[</span><span class="token string">&quot;Revenue (Millions)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span>movie<span class="token punctuation">[</span><span class="token string">&quot;Revenue (Millions)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  
<span class="token comment">#更换指定列中的np.NaN为 Revenue (Millions)的中位值  inplace为是否替换原来数据 默认为false不替换原来数据</span>

<span class="token comment">#将评分列的缺失值，替换为上一个电影的评分</span>
df<span class="token punctuation">[</span><span class="token string">'评分'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>

<span class="token comment">#上下均值填充</span>
df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>interpolate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#匹配填充</span>
df<span class="token punctuation">[</span><span class="token string">'语言'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'国家/地区'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>语言<span class="token punctuation">.</span>bfill<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token comment">#bfill:向前填充  ffill:向后填充  默认 axis=0(列方向)  vs  axis=1(行方向)</span>
</code></pre></div></li></ul></li> <li><p>df.replace(to_replace=, value=)</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#先把被标记的缺失值 也是? 替换成np.nan</span>
wis <span class="token operator">=</span> wis<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>to_replace<span class="token operator">=</span><span class="token string">'?'</span><span class="token punctuation">,</span>value<span class="token operator">=</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">)</span>
<span class="token comment">#再进行缺失值处理</span>
wis <span class="token operator">=</span> wis<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>
wis<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <h3 id="缺失值转换"><a href="#缺失值转换" class="header-anchor">#</a> 缺失值转换</h3> <p>不将缺失值标记为 NAN</p> <div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> keep_default_na<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
data
</code></pre></div><p>NaN会变成空字符</p> <h3 id="缺失值标记"><a href="#缺失值标记" class="header-anchor">#</a> 缺失值标记</h3> <p>将指定的字符标记为NaN缺失值</p> <div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span>na_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'[]'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data
</code></pre></div><h3 id="缺失值忽略"><a href="#缺失值忽略" class="header-anchor">#</a> 缺失值忽略</h3> <p>忽略缺失值 变为空字符串</p> <div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;某招聘网站数据.csv&quot;</span><span class="token punctuation">,</span>na_filter<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
data
</code></pre></div><h2 id="数据离散化"><a href="#数据离散化" class="header-anchor">#</a> 数据离散化</h2> <p>连续属性的离散化就是在连续属性的值域上，将值域划分为若干个离散的区间，最后用不同的符号或整数 值代表落在每个子区间中的属性值。</p> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211103094218035.png" alt="image-20211103094218035"></p> <ul><li><p>pd.qcut(data, q)  对数据进行分组将数据分组，一般会与value_counts搭配使用，统计每组的个数  即将数据划分为指定个数的区间</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 自行分组</span>
qcut <span class="token operator">=</span> pd<span class="token punctuation">.</span>qcut<span class="token punctuation">(</span>p_change<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">#将此数据集 离散化平均分10个组</span>
<span class="token comment"># 计算分到每个组数据个数</span>
qcut<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#查看每个组共有多少个数据集</span>
</code></pre></div></li></ul></li> <li><p>series.value_counts()：统计分组次数</p></li> <li><p>pd.cut(data, bins) 自定义区间分组</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>bins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>  <span class="token comment"># 通过自定义区间范围来分组</span>
cut_r <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>data_p<span class="token punctuation">,</span> bins<span class="token operator">=</span>bins<span class="token punctuation">)</span>
cut_r<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>        <span class="token number">215</span>
<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>       <span class="token number">188</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>         <span class="token number">57</span>
<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>       <span class="token number">51</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>         <span class="token number">35</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>       <span class="token number">35</span>
<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">]</span>     <span class="token number">34</span>
<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span>       <span class="token number">28</span>
Name<span class="token punctuation">:</span> p_change<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64
</code></pre></div></li></ul></li></ul> <h3 id="one-hot编码"><a href="#one-hot编码" class="header-anchor">#</a> one-hot编码</h3> <p>把每个类别生成一个布尔列，这些列中只有一列可以为这个样本取值为1.其又被称为独热编码。</p> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211103094600578.png" alt="image-20211103094600578"></p> <ul><li>pd.get_dummies(data,prefix=&quot;区间前缀测试&quot;)   将据转为 one-hot编码  prefix为区间前缀方便阅读和理解</li></ul> <h2 id="数据合并"><a href="#数据合并" class="header-anchor">#</a> 数据合并</h2> <h3 id="concat"><a href="#concat" class="header-anchor">#</a> concat</h3> <ul><li><p>pd.concat([data1, data2], axis=1)   将两个df进行合并</p> <ul><li><p>按照行或列进行合并,axis=0为列索引，axis=1为行索引</p></li> <li><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#默认为行连接  通过指定axis=1为按列连接</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">,</span>data_dummies<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#横向拼接</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>df3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#重置拼接</span>
</code></pre></div></li> <li><p>ignore_index: 重置索引 默认为flase</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df4<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>join: 什么方式加入</p> <ul><li><p>inner:默认 内连接</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df4<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>join<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul></li> <li><p>keys: 每个表拆分 来区分不同的表数据来源</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> df3<span class="token punctuation">]</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


A	B	C	D
x	<span class="token number">0</span>	A0	B0	C0	D0
<span class="token number">1</span>	A1	B1	C1	D1
<span class="token number">2</span>	A2	B2	C2	D2
<span class="token number">3</span>	A3	B3	C3	D3
y	<span class="token number">4</span>	A4	B4	C4	D4
<span class="token number">5</span>	A5	B5	C5	D5
<span class="token number">6</span>	A6	B6	C6	D6
<span class="token number">7</span>	A7	B7	C7	D7
z	<span class="token number">8</span>	A8	B8	C8	D8
<span class="token number">9</span>	A9	B9	C9	D9
<span class="token number">10</span>	A10	B10	C10	D10
<span class="token number">11</span>	A11	B11	C11	D11
</code></pre></div></li></ul></li></ul></li></ul> <h3 id="merge"><a href="#merge" class="header-anchor">#</a> merge</h3> <ul><li><p>pd.merge(left, right, how='inner', on=None)</p> <ul><li><p>可以指定按照两组数据的共同键值对合并或者左右各自</p></li> <li><p>left  : DataFrame</p></li> <li><p>right  : 另一个DataFrame</p></li> <li><p>on  : 指定的共同键</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">)</span> <span class="token comment">#以名称为key的列为共同键连接</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">,</span> <span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 多键</span>
</code></pre></div></li></ul></li> <li><p>how:按照什么方式连接</p> <ul><li><p>left:左连接</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>right:右连接</p></li> <li><p>outer:全外连接</p></li> <li><p>inner: 内连接</p></li></ul></li> <li><p>suffixes:将连接表除on键 以外的列 为前缀再区分数据</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> suffixes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'_l'</span><span class="token punctuation">,</span> <span class="token string">'_r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


k	v_l	v_r
<span class="token number">0</span>	K0	<span class="token number">1</span>	<span class="token number">4</span>
<span class="token number">1</span>	K0	<span class="token number">1</span>	<span class="token number">5</span>

</code></pre></div></li></ul></li> <li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#默认为内连接</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;inner&quot;</span><span class="token punctuation">)</span>   <span class="token comment">#通过how属性指定连接类型 默认inner为内连接</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;outer&quot;</span><span class="token punctuation">)</span>   <span class="token comment">#outer 满外连接 没有的值会以NaN存在 需要注意</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 左连接</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;right&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 右连接</span>
</code></pre></div></li></ul></li></ul> <h3 id="join-组合"><a href="#join-组合" class="header-anchor">#</a> join 组合</h3> <ul><li><p>df1.join(right,how=&quot;outer&quot;)  将两表进行组合 默认为内连接</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">)</span> 
</code></pre></div></li> <li><p>how: 连接方式</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&quot;outer&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>outer</p></li> <li><p>left</p></li> <li><p>right</p></li> <li><p>inner</p></li></ul></li> <li><p>on: 共同键  按列名</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'v1'</span><span class="token punctuation">)</span>
left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#多个列</span>
</code></pre></div></li></ul></li></ul></li></ul> <h2 id="交叉表与透视表"><a href="#交叉表与透视表" class="header-anchor">#</a> 交叉表与透视表</h2> <ul><li><p>pd.crosstab(value1, value2)    pd.crosstab(value1, value2)  交叉表用于计算一列数据对于另外一列数据的分组个数(用于统计分组频率的特殊透视表)</p></li> <li><p>df.pivot_table([], ,values = [],index=[],aggfunc=&quot;mean&quot;)   透视表是将原有的DataFrame的列分别作为行索引和列索引，然后对指定的列应用聚集函数</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;p_n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token string">&quot;week&quot;</span><span class="token punctuation">)</span>  

	p_n
week	
<span class="token number">0</span>	<span class="token number">0.496000</span>
<span class="token number">1</span>	<span class="token number">0.580153</span>
<span class="token number">2</span>	<span class="token number">0.537879</span>
<span class="token number">3</span>	<span class="token number">0.507812</span>
<span class="token number">4</span>	<span class="token number">0.535433</span>

pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">,</span><span class="token string">'利润'</span><span class="token punctuation">,</span><span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token string">'类别'</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span> <span class="token comment">#多列(指标)</span>
pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">,</span><span class="token string">'类别'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span> <span class="token comment"># 多索引</span>
</code></pre></div></li> <li><p>values :指标</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token string">'省/自治区'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>index:索引名</p></li> <li><p>columns: 列名</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'类别'</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span> <span class="token comment">#多层</span>
</code></pre></div></li></ul></li> <li><p>aggfunc: 透视图使用的方法 默认为mean平均值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token string">'省/自治区'</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token string">'省/自治区'</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token builtin">sum</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#多个聚合方法</span>
</code></pre></div></li></ul></li> <li><p>margins:  string，默认为‘ALL’，当参数margins为True时，ALL行和列的名字</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">,</span><span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">,</span><span class="token string">'类别'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token builtin">sum</span><span class="token punctuation">]</span><span class="token punctuation">,</span>margins<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>df.melt()  逆透视</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>table <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">,</span><span class="token string">'利润'</span><span class="token punctuation">,</span><span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token string">'类别'</span><span class="token punctuation">,</span>aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span>
table<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>var_name<span class="token operator">=</span><span class="token string">'分类'</span><span class="token punctuation">,</span>value_name<span class="token operator">=</span><span class="token string">'金额'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul></li></ul> <h2 id="分组与聚合"><a href="#分组与聚合" class="header-anchor">#</a> 分组与聚合</h2> <p>分组与聚合通常是分析数据的一种方式，通常与一些统计函数一起使用，查看数据的分组情况</p> <ul><li><p>df.groupby(key, as_index=False)</p> <ul><li><p>key:分组的列数据，可以多个</p></li> <li><div class="language-python extra-class"><pre class="language-python"><code>col<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;price1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#按照列索引color分组  再根据分组后的price1列求中位值</span>
col<span class="token punctuation">[</span><span class="token string">&quot;price1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">[</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#取出price1的值 再按color分组 再求中位值</span>
col<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;price1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#为分组聚合后的数据给行索引</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'district'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#分组并排序</span>

pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;district&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'companySize'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;行政区&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;公司规模&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#分组后 修改索引名</span>
</code></pre></div></li> <li><p>groupby().groups  以字典形式查看各分组内容</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;district&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groups

<span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token string">'上城区'</span><span class="token punctuation">,</span> <span class="token number">22500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'上城区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'下沙'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">7500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">22500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">27500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">29000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">35000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">37500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'余杭区'</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'拱墅区'</span><span class="token punctuation">,</span> <span class="token number">24000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'拱墅区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'江干区'</span><span class="token punctuation">,</span> <span class="token number">3500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'江干区'</span><span class="token punctuation">,</span> <span class="token number">22500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'江干区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'江干区'</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">7500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">15000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">22500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">32500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">37500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">42500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'滨江区'</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'萧山区'</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'萧山区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'萧山区'</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">6500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">21500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">22500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">24000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">26500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">27000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">27500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">35000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">36500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">37500</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'西湖区'</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>groupby().get_group  查看分组后指定值数据</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;district&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_group<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;西湖区&quot;</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>groupby().transform(&quot;聚合函数名&quot;)  分组转换</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token string">'该区平均工资'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'district'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">'mean'</span><span class="token punctuation">)</span>
df
</code></pre></div></li></ul></li> <li><p>groupby().filter()  分组过滤</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">30000</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>groupby().agg([&quot;聚合函数名1&quot;,&quot;聚合函数名2&quot;])  将分组的数据 聚合统计</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'positionName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'salary'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>median<span class="token punctuation">,</span> <span class="token string">'score'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#指定以指定聚合函数来获取值</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>
    <span class="token punctuation">{</span><span class="token string">'salary'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> np<span class="token punctuation">.</span>median<span class="token punctuation">,</span> np<span class="token punctuation">.</span>std<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'score'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#多层聚合</span>


<span class="token comment">#自定义函数聚合</span>
<span class="token keyword">def</span> <span class="token function">myfunc</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>最低工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 最高工资<span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 平均工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 最大值与均值差值<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> myfunc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;行政区&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div></li> <li><p>agg.rename_axis(&quot;列名&quot;)  修改列名</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>最低工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 最高工资<span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 平均工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;行政区&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul></li></ul> <h3 id="分组可视化"><a href="#分组可视化" class="header-anchor">#</a> 分组可视化</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token operator">%</span>config InlineBackend<span class="token punctuation">.</span>figure_format <span class="token operator">=</span> <span class="token string">'retina'</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Songti SC'</span><span class="token punctuation">]</span>


df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;district&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'positionName'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'#5172F0'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>

plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;公司数量&quot;</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;杭州市各区&quot;</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></li></ul> <p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211105215843103.png" alt="image-20211105215843103"></p> <h2 id="时间处理"><a href="#时间处理" class="header-anchor">#</a> 时间处理</h2> <p>从文件中读取的时间默认我object类型 需要转为pd时间才能进行运算</p> <ul><li>pd.to_datetime(data)  将指定列转为时间序列  返回datatime对象</li> <li>datetime.weekday  星期几</li> <li>datetime.week  月中第几个星期</li> <li>datetime.day  几号</li> <li>datetime.year 年</li> <li>datetime.total_seconds()  将时间转为秒</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>t1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">&quot;2021-11-03 10:30:00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">&quot;2021-11-03 12:30:00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">)</span>

time <span class="token operator">=</span> <span class="token punctuation">(</span>t2<span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#获取时间差</span>
</code></pre></div><h2 id="去重"><a href="#去重" class="header-anchor">#</a> 去重</h2> <ul><li><p>df.drop_duplicates(subset=['列名'], keep='first')  去重 只保留第一个</p> <ul><li><p>keep: first为保留重复值中第一个  last为保留最后一个</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>keep<span class="token operator">=</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>subset: 列名</p></li></ul></li> <li><p>df[&quot;列名&quot;].uniue()</p></li> <li><p>查找行是否存在重复值</p> <ul><li><div class="language-py extra-class"><pre class="language-py"><code>df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token number">2</span>      <span class="token boolean">True</span>
<span class="token number">3</span>      <span class="token boolean">True</span>
<span class="token number">4</span>      <span class="token boolean">True</span>
<span class="token number">5</span>      <span class="token boolean">True</span>
<span class="token number">6</span>      <span class="token boolean">True</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token number">257</span>    <span class="token boolean">True</span>
<span class="token number">258</span>    <span class="token boolean">True</span>
<span class="token number">259</span>    <span class="token boolean">True</span>
<span class="token number">260</span>    <span class="token boolean">True</span>
<span class="token number">261</span>    <span class="token boolean">True</span>
Length<span class="token punctuation">:</span> <span class="token number">260</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">bool</span>
</code></pre></div></li></ul></li> <li><p>查询指定列中的重复值</p> <ul><li><div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'片名'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div></li></ul></li></ul> <h2 id="热力图"><a href="#热力图" class="header-anchor">#</a> 热力图</h2> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_precision<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">### 方法二 ###</span>

<span class="token comment">#借助 `matplotlib` 和 `seaborn` </span>

<span class="token comment"># 其中中文设置可以参考我的这篇文章 https://mp.weixin.qq.com/s/WKOGvQP-6QUAP00ZXjhweg</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">'Songti SC'</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'RdBu'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211105212131147.png" alt="image-20211105212131147"></p> <h2 id="热力地图"><a href="#热力地图" class="header-anchor">#</a> 热力地图</h2> <p>结合 pyecharts 进行地图可视化</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts
<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Map
list1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>省市<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span>
list2 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>省市<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>省市<span class="token punctuation">)</span>


c <span class="token operator">=</span> <span class="token punctuation">(</span>
    Map<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>list1<span class="token punctuation">,</span>list2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;china&quot;</span><span class="token punctuation">,</span>is_map_symbol_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
        title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;排名前100高校各省市占比&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        visualmap_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>VisualMapOpts<span class="token punctuation">(</span>max_<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       

    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
c<span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://gitee.com/Iekrwh/md-images/raw/master/images/image-20211105212242597.png" alt="image-20211105212242597"></p> <h2 id="直方图"><a href="#直方图" class="header-anchor">#</a> 直方图</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">'Songti SC'</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>distplot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'总分'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/doc-vuepress/机器学习/Numpy.html" class="prev">
        Numpy
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc-vuepress/assets/js/app.d9f058a2.js" defer></script><script src="/doc-vuepress/assets/js/2.3b3db5cf.js" defer></script><script src="/doc-vuepress/assets/js/226.9269748b.js" defer></script>
  </body>
</html>
