(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{527:function(t,s,a){"use strict";a.r(s);var e=a(46),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#触发器"}},[t._v("#")]),t._v(" 触发器")]),t._v(" "),a("p",[t._v("触发器会把我们 添加 修改 删除 操作之前或之后 触发执行 触发器 中定义的SQL语句")]),t._v(" "),a("p",[t._v("这些特性可以作为 日志记录 数据校验 确保数据完整性")]),t._v(" "),a("p",[t._v("使用 别名 NEW 和 OLD 关键字来引用触发器 发生变化的内容记录")]),t._v(" "),a("p",[t._v("NEW 为触发后表的数据 为一个单行多列结果")]),t._v(" "),a("p",[t._v("OLD 为触发器前表的数据")]),t._v(" "),a("p",[t._v("OLD 是只读的，而 NEW 则可以在触发器中使用 SET 赋值，这样不会再次触发触发器，造成循环调用（如每插入一个学生前，都在其学号前加“2013”）。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210816230726022.png",alt:"image-20210816230726022"}})]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("-- 创建触发器\ndelimiter $\n\ncreate trigger 触发器名称\nbefore|after(定义操作前/后)     insert|update|delete(定义触发器类型)\non 表名\nfor each row\nbegin\n\t\tsql语句;\n\t\t-- 可以使用 NEW / OLD 关键字来获取更新前后的数据 如new.name old.name\n\t\t\nend$\n\ndelimiter$\n")])])]),a("p",[t._v("样例")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delimiter")]),t._v(" $$\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRIGGER")]),t._v(" upd_check \nBEFORE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" account\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FOR EACH ROW")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n 　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" NEW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("THEN")]),t._v("\n 　　　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" NEW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ELSEIF")]),t._v(" NEW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("THEN")]),t._v("\n 　　　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" NEW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("$$\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delimiter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("查看触发器 show triggers;")]),t._v(" "),a("li",[t._v("删除触发器 drop trigger 触发器名称;")])])])}),[],!1,null,null,null);s.default=n.exports}}]);