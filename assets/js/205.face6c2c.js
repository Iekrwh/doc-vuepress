(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{581:function(t,s,a){"use strict";a.r(s);var n=a(46),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"打包发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包发布"}},[t._v("#")]),t._v(" 打包发布")]),t._v(" "),a("p",[t._v("在发布上线前,我们需要执行构建打包,把.less、.vue、.js 相关资源进行编译打包,转成浏览器可以直接识别运行的普通css、js、html")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yarn run build 或者 yarn build")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),a("h2",{attrs:{id:"本地预览测试打包结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地预览测试打包结果"}},[t._v("#")]),t._v(" 本地预览测试打包结果")]),t._v(" "),a("p",[t._v("不能直接本地双击打开index.html运行")]),t._v(" "),a("p",[t._v("将dist放到一个web服务器中运行测试如")]),t._v(" "),a("ul",[a("li",[t._v("Ngxin")]),t._v(" "),a("li",[t._v("Apache")]),t._v(" "),a("li",[t._v("tomacat")]),t._v(" "),a("li",[t._v("IIS")]),t._v(" "),a("li",[t._v("Node.js")])]),t._v(" "),a("p",[t._v("这里我们使用Vue官方推荐的Serve https://cli.vuejs.org/zh/guide/deployment.html#%E9%80%9A%E7%94%A8%E6%8C%87%E5%8D%97")]),t._v(" "),a("p",[t._v("必须要打包后并且本地有dist目录")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g serve "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全局安装的安装后不用安装")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -s 参数的意思是将其架设在 Single-Page Application 模式下")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个模式会处理即将提到的路由问题")]),t._v("\nserve -s dist  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以管理员身份进行运行")]),t._v("\n")])])]),a("h2",{attrs:{id:"github-pages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-pages"}},[t._v("#")]),t._v(" GitHub Pages")]),t._v(" "),a("h2",{attrs:{id:"github-域名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-域名"}},[t._v("#")]),t._v(" GitHub 域名")]),t._v(" "),a("p",[t._v("每个用户提供了免费的域名")]),t._v(" "),a("ul",[a("li",[t._v("用户名.github.io/仓库名/")])]),t._v(" "),a("p",[t._v("如果想要忽略后面的仓库名参数 如:用户.github.io,则需要把仓库名命名为"),a("code",[t._v("用户名.github.io")]),t._v("，GitHub默认会自动给这个仓库托管，有且只能有一个，这个仓库，因为每个用户只有一个域名。")]),t._v(" "),a("h3",{attrs:{id:"自定义域名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义域名"}},[t._v("#")]),t._v(" 自定义域名")]),t._v(" "),a("ol",[a("li",[t._v("域名后台添加一个CNAME 记录")]),t._v(" "),a("li",[t._v("在项目中添加一个CNAME文件，并填入自定义域名地址")])]),t._v(" "),a("h2",{attrs:{id:"将我们的项目部署到-github-pages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将我们的项目部署到-github-pages"}},[t._v("#")]),t._v(" 将我们的项目部署到 GitHub pages")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("因为项目中接口都是http协议,而GitHub上强制开启https,在https中无法发出http请求,所以我们要准备一个自己的域名才能使用htpp或htpps")])]),t._v(" "),a("li",[a("p",[t._v("映射CNAME记录到github项目中")])]),t._v(" "),a("li",[a("p",[t._v("生成令牌")]),t._v(" "),a("ol",[a("li",[t._v("用户设置")]),t._v(" "),a("li",[a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629122805743.png",alt:"image-20210629122805743"}}),t._v("开发者选项")]),t._v(" "),a("li",[a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629122853854.png",alt:"image-20210629122853854"}}),a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629122923291.png",alt:"image-20210629122923291"}}),t._v("生成密钥")]),t._v(" "),a("li",[a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629123109691.png",alt:"image-20210629123109691"}})]),t._v(" "),a("li",[t._v("生成 复制token")])])]),t._v(" "),a("li",[a("p",[t._v("推送并在项目中设置中设置secret 把生成的令牌复制到新建的secret中")]),t._v(" "),a("p",[t._v("1."),a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629123246355.png",alt:"image-20210629123246355"}}),t._v(" "),a("img",{attrs:{src:"https://gitee.com/Iekrwh/md-images/raw/master/images/image-20210629123255499.png",alt:"image-20210629123255499"}}),t._v("\n2. NAME: ACCESS_TOKEN  TOKEN: TOKEN")])]),t._v(" "),a("li",[a("p",[t._v("在项目中添加 "),a("code",[t._v(".github/workflow/mian.yml")])]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" build and deploy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当 master 分支 push 代码的时候触发 workflow")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build-deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 下载仓库代码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v2\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 缓存依赖")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Get yarn cache\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cache\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' echo "'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("set"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("output name=dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('$(yarn cache dir)"\n    '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v1\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" steps.yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cache.outputs.dir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" runner.os "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hashFiles('"),a("span",{pre:!0,attrs:{class:"token important"}},[t._v("**/yarn.lock')")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restore-keys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n          ${{ runner.os }}-yarn-")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装依赖")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yarn\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包构建")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yarn build\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发布到 GitHub Pages")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peaceiris/actions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v2\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PERSONAL_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.ACCESS_TOKEN "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问秘钥")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PUBLISH_BRANCH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 推送分支")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PUBLISH_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./dist "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署目录")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("GitHub Action 工作流")])])]),t._v(" "),a("li",[a("p",[t._v("public 中 添加 CNAME 自定义域名的域名")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);